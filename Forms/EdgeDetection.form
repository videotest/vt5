[AxForm]
Version=1
Size=713, 133
Title=

[AXControls]
Name=txtEdgeDet
ProgID=VTCONTROLS.VTStaticText.1
Rect=7, 1, 338, 14
Style=50000000h
ID=123
Data=257 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 bc 02 44 42 01 00 06 54 61 68 6f 6d 61 0a 00 00 00 12 00 00 80 0f 00 00 80 0f 00 00 80 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0f 20 45 64 67 65 20 44 65 74 65 63 74 69 6f 6e 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 10 00 ff ff ff ff ff ff ff ff 42 4d 36 00 00 00 00 00 00 00 36 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 10 00 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 58 78 ef 81 0c 60 ee 81 01 00 00 00 01 00 00 00 0f 00 00 80 00 00 00 00

Name=Control841
ProgID=VTDESIGN.VTD3DBarCtrl.1
Rect=5, 14, 703, 19
Style=50000000h
ID=123
Data=73 00 00 00 00 03 00 00 00 03 00 02 00 00 00 05 00 00 80 01 00 00 00 08 00 00 80 00 64 00 00 00 00 00 01 00 01 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61

Name=txtSettings
ProgID=VTCONTROLS.VTStaticText.1
Rect=125, 16, 181, 30
Style=50000000h
ID=0
Data=324 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 0b 00 00 00 08 00 00 80 0f 00 00 80 0f 00 00 80 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 53 65 74 74 69 6e 67 73 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 11 00 ff ff ff ff ff ff ff ff 42 4d 36 00 00 00 00 00 00 00 36 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 10 00 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c4 9d ce 81 0c 90 ce 81 42 4d 3e 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 01 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff 00 60 00 00 00 01 00 00 00 01 00 00 00 0f 00 00 80 00 00 00 00 00 00 00 00 01 00 00 00

Name=btnFitToScreen
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=154, 89, 176, 111
Style=50000000h
ID=0
Data=973 0c 01 01 01 00 00 00 00 00 1d 45 3a 5c 50 53 44 5c 76 74 35 5c 6d 61 73 74 65 72 5c 62 6d 70 5c 77 69 6e 2e 62 6d 70 1d 45 3a 5c 50 53 44 5c 76 74 35 5c 6d 61 73 74 65 72 5c 62 6d 70 5c 77 69 6e 2e 62 6d 70 01 00 01 00 01 00 00 00 00 00 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 04 01 01 16 00 00 00 16 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 ff 00 ff 00 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 01 00 42 4d 06 03 00 00 00 00 00 00 36 00 00 00 28 00 00 00 10 00 00 00 0f 00 00 00 01 00 18 00 00 00 00 00 d0 02 00 00 12 0b 00 00 12 0b 00 00 00 00 00 00 00 00 00 00 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ce de e1 a5 b2 b4 00 00 00 a5 b2 b4 ce de e1 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ce de e1 a5 b2 b4 a9 88 6b f3 ce ae 00 00 00 a5 b2 b4 ce de e1 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff c4 d3 d6 a9 88 6b a9 88 6b a9 88 6b a9 88 6b a9 88 6b c4 d3 d6 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ce de e1 ba c8 cb af bd c0 af bd c0 af bd c0 ba c8 cb ce de e1 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ce de e1 c4 d3 d6 c0 e1 ef 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ce de e1 c4 d3 d6 ce de e1 ff 00 ff ce de e1 a5 b2 b4 00 00 00 b4 dc f1 00 00 00 fc f9 f6 fc f9 f6 fb f6 f1 fa ee e3 f7 e4 d2 f5 d9 c1 00 00 00 ba c8 cb 00 00 00 a5 b2 b4 ce de e1 a5 b2 b4 00 00 00 8b 70 58 a6 d7 f4 00 00 00 fc f9 f6 fc f9 f6 fc f9 f6 fb f2 eb f9 e9 db f6 de c9 00 00 00 af bd c0 a9 88 6b 00 00 00 a5 b2 b4 a9 88 6b f3 ce ae 8b 70 58 9a d2 f6 00 00 00 fc f9 f6 fc f9 f6 fc f9 f6 fb f6 f1 fa ee e3 f7 e4 d2 00 00 00 af bd c0 a9 88 6b f3 ce ae 00 00 00 a5 b2 b4 a9 88 6b a9 88 6b 91 cf f7 00 00 00 fc f9 f6 fc f9 f6 fc f9 f6 fc f9 f6 fb f2 eb f9 e9 db 00 00 00 af bd c0 a9 88 6b a9 88 6b a5 b2 b4 ce de e1 a5 b2 b4 a9 88 6b 91 cf f7 7d 65 4f 7d 65 4f 7d 65 4f 7d 65 4f 7d 65 4f 7d 65 4f 7d 65 4f 7d 65 4f ba c8 cb a9 88 6b a5 b2 b4 ce de e1 ff 00 ff ce de e1 c4 d3 d6 91 cf f7 a9 88 6b a9 88 6b a9 88 6b a9 88 6b a9 88 6b a9 88 6b a9 88 6b a9 88 6b ce de e1 c4 d3 d6 ce de e1 ff 00 ff ff 00 ff ff 00 ff ff 00 ff 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 a2 d5 f4 b8 de f1 c9 e4 ee ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff c4 d3 d6 a9 88 6b 00 00 00 00 00 00 00 00 00 00 00 00 c4 d3 d6 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ce de e1 a5 b2 b4 a9 88 6b f3 ce ae 00 00 00 a5 b2 b4 ce de e1 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ce de e1 a5 b2 b4 a9 88 6b a5 b2 b4 ce de e1 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff

Name=btnZoom0
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=129, 89, 151, 111
Style=50000000h
ID=0
Data=977 0c 01 01 01 00 00 00 00 00 1f 45 3a 5c 50 53 44 5c 76 74 35 5c 6d 61 73 74 65 72 5c 62 6d 70 5c 7a 6f 6f 6d 31 2e 62 6d 70 1f 45 3a 5c 50 53 44 5c 76 74 35 5c 6d 61 73 74 65 72 5c 62 6d 70 5c 7a 6f 6f 6d 31 2e 62 6d 70 01 00 01 00 01 00 00 00 00 00 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 04 01 01 16 00 00 00 16 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 ff 00 ff 00 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 01 00 42 4d 06 03 00 00 00 00 00 00 36 00 00 00 28 00 00 00 10 00 00 00 0f 00 00 00 01 00 18 00 00 00 00 00 d0 02 00 00 12 0b 00 00 12 0b 00 00 00 00 00 00 00 00 00 00 ff 00 ff ff 00 ff ff 00 ff 00 00 00 00 00 00 00 00 00 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff d1 e2 e5 c4 d3 d6 c4 d3 d6 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 00 00 00 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff d1 e2 e5 b7 c5 c8 96 a2 a4 9d a9 ab c4 d3 d6 ff 00 ff ff 00 ff 5f 66 68 9d a9 ab 00 00 00 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff d1 e2 e5 b7 c5 c8 17 7b bb 5f 66 68 96 a2 a4 c4 d3 d6 ff 00 ff ff 00 ff ff 00 ff 00 00 00 00 00 00 ff 00 ff ff 00 ff ff 00 ff ff 00 ff d1 e2 e5 b7 c5 c8 17 7b bb 91 cf f7 04 05 06 b7 c5 c8 d1 e2 e5 ff 00 ff ff 00 ff d1 e2 e5 c4 d3 d6 00 00 00 bd cc cf bd cc cf bd cc cf bd cc cf b0 be c0 17 7b bb 91 cf f7 04 05 06 b7 c5 c8 d1 e2 e5 ff 00 ff ff 00 ff d1 e2 e5 b7 c5 c8 96 a2 a4 89 93 95 89 93 95 89 93 95 89 93 95 89 93 95 17 7b bb 91 cf f7 3b 48 51 b7 c5 c8 d1 e2 e5 ff 00 ff ff 00 ff d3 e4 e7 bb c9 cc 8b 70 53 68 49 2e 57 38 1e 4d 2c 14 56 35 1c 60 40 25 17 7b bb 91 cf f7 3b 48 51 b0 be c0 d1 e2 e5 ff 00 ff ff 00 ff ff 00 ff ca d9 dc 8e 74 59 8b 71 54 ad 96 80 ba a5 92 c2 b0 9d 9b 81 68 4c 2c 14 21 06 00 02 03 03 89 93 95 bd cc cf ff 00 ff ff 00 ff ff 00 ff ff 00 ff a1 90 7e 9c 83 6a cd bd ae d0 c0 b2 c8 b7 a6 c7 e4 f7 c7 e4 f7 ad 97 80 59 3b 21 96 7b 62 89 93 95 bd cc cf ff 00 ff ff 00 ff ff 00 ff ff 00 ff 98 88 76 c2 b0 9e de d3 c9 d5 c8 b9 ce be ae cf bf b0 c7 e4 f7 d8 cc c0 7b 5f 43 61 40 26 89 93 95 bd cc cf ff 00 ff ff 00 ff ff 00 ff ff 00 ff 9e 90 7d d3 c5 b7 e9 e0 d9 db cf c2 d4 c7 b8 ce bd ae ca b8 a8 c9 b8 a8 88 6a 51 5b 3c 21 89 93 95 bd cc cf ff 00 ff ff 00 ff ff 00 ff ff 00 ff ac a0 8f d3 c4 b7 ed e6 e0 e4 da cf db cf c3 d5 c8 b8 cd bb ac c1 ad 9a 8a 6f 54 6f 50 35 96 a2 a4 c4 d3 d6 ff 00 ff ff 00 ff ff 00 ff ff 00 ff b9 ac 9d c5 b4 a2 ed e7 e0 ee e8 e2 e5 dc d4 de d2 c6 da cf c2 c2 b0 9d 78 5b 41 9e 84 6c b7 c5 c8 d1 e2 e5 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff bc a9 95 ca bb ab e1 d7 ce ea e2 dc e4 db d0 c8 b8 a7 90 76 5b 8c 70 55 b7 c5 c8 d1 e2 e5 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff be a9 96 b1 9c 87 a8 91 7a 9b 83 6a 96 7d 64 a4 8b 74 c4 d3 d6 d1 e2 e5 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff

Name=sldZoom
ProgID=VTCONTROLS.VTSlider.1
Rect=180, 89, 285, 109
Style=50000000h
ID=0
Data=121 00 00 01 00 44 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 01 00 00 00 03 00 00 00 00 00 00 00 00 00 00 00 19 00 00 00 10 00 00 00 00 00 00 00 0a 00 00 00 c8 00 00 00 38 ff ff ff c8 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 01 00 00 00

Name=edtZoomValue
ProgID=VTCONTROLS.VTEditor.1
Rect=289, 89, 332, 111
Style=58000000h
ID=0
Data=230 00 00 01 00 09 00 00 00 f5 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 01 00 00 00 00 54 61 68 6f 6d 61 00 20 53 65 72 69 66 00 09 09 09 09 09 09 09 09 0a 09 09 09 73 74 72 53 70 65 f5 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 01 00 00 00 00 54 61 68 6f 6d 61 00 20 53 65 72 69 66 00 09 09 09 09 09 09 09 09 0a 09 09 09 73 74 72 53 70 65 08 56 54 45 64 69 74 6f 72 00 00 00 00 00 00 00 00 00 04 45 64 69 74 64 00 00 00 00 00 01 00 00 00 00 00 c8 42 00 00 00 00 08 00 00 80 0f 00 00 80 08 00 00 80 0f 00 00 80 0f 00 00 80 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

Name=Control1265
ProgID=VTDESIGN.VTD3DBarCtrl.1
Rect=121, 80, 339, 122
Style=58000000h
ID=0
Data=72 00 00 00 00 03 00 00 00 03 00 02 00 00 00 05 00 00 80 01 00 00 00 08 00 00 80 00 64 00 00 00 00 00 01 00 01 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 05 41 72 69 61 6c

Name=txtZoom
ProgID=VTCONTROLS.VTStaticText.1
Rect=125, 65, 199, 80
Style=50000000h
ID=0
Data=327 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 0b 00 00 00 08 00 00 80 0f 00 00 80 0f 00 00 80 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0b d3 e2 e5 eb e8 f7 e5 ed e8 e5 3a 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 11 00 ff ff ff ff ff ff ff ff 42 4d 36 00 00 00 00 00 00 00 36 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 10 00 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 42 4d 3e 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 01 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff 00 00 00 00 00 01 00 00 00 01 00 00 00 0f 00 00 80 00 00 00 00 00 00 00 00 01 00 00 00

Name=txtSettingsBorder
ProgID=VTDESIGN.VTD3DBarCtrl.1
Rect=121, 31, 425, 65
Style=58000000h
ID=123
Data=73 00 00 00 00 03 00 00 00 03 00 02 00 00 00 05 00 00 80 01 00 00 00 08 00 00 80 00 64 00 00 00 00 00 01 00 01 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 ac 07 01 00 06 54 61 68 6f 6d 61

Name=edtPower
ProgID=VTCONTROLS.VTEditor.1
Rect=294, 36, 416, 57
Style=50010000h
ID=123
Data=238 00 00 01 00 09 00 00 00 f5 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 01 00 00 00 00 54 61 68 6f 6d 61 00 00 00 00 3d c7 00 78 d8 0f 00 00 ff ff ff ff b1 12 00 78 f0 e0 9d 00 60 f1 f5 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 01 00 00 00 00 54 61 68 6f 6d 61 00 e6 82 00 bc e6 82 00 00 00 00 00 00 00 00 00 34 ab 72 81 0c 00 60 00 60 f1 08 56 54 45 64 69 74 6f 72 01 00 0b 43 6f 65 66 66 69 63 69 65 6e 74 01 00 00 00 01 00 01 31 4b 00 01 00 00 00 01 00 00 00 00 00 20 41 00 00 80 3f 08 00 00 80 05 00 00 80 08 00 00 80 0f 00 00 80 0f 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

Name=chkAdd
ProgID=VTCHECKBOX.VTCheckBoxCtrl.1
Rect=127, 36, 290, 57
Style=50000000h
ID=123
Data=124 00 00 00 00 04 00 00 00 00 00 00 00 15 20 20 41 64 64 20 74 6f 20 53 6f 75 72 63 65 20 49 6d 61 67 65 08 00 00 80 0f 00 00 80 08 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61

Name=btnSplit
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=356, 89, 378, 111
Style=50000000h
ID=0
Data=979 0c 01 01 01 01 00 00 00 00 20 45 3a 5c 50 53 44 5c 76 74 35 5c 6d 61 73 74 65 72 5c 62 6d 70 5c 77 69 6e 64 69 76 2e 62 6d 70 20 45 3a 5c 50 53 44 5c 76 74 35 5c 6d 61 73 74 65 72 5c 62 6d 70 5c 77 69 6e 64 69 76 2e 62 6d 70 01 00 01 00 01 00 00 00 00 00 00 00 05 00 0b 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 20 01 01 16 00 00 00 16 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 ff 00 ff 00 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 01 00 42 4d 06 03 00 00 00 00 00 00 36 00 00 00 28 00 00 00 10 00 00 00 0f 00 00 00 01 00 18 00 00 00 00 00 d0 02 00 00 12 0b 00 00 12 0b 00 00 00 00 00 00 00 00 00 00 ff 00 ff c0 ce d0 9f a8 aa 90 98 99 90 98 99 90 98 99 90 98 99 90 98 99 90 98 99 90 98 99 90 98 99 90 98 99 90 98 99 90 98 99 a2 ac ae ff 00 ff ca de e5 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 90 98 99 c0 ce d0 b9 d7 e5 00 00 00 f5 d6 ba f4 d3 b6 f3 d1 b2 f3 d0 b0 69 55 42 1c 94 f7 69 55 42 f4 d6 b9 f4 d4 b7 f4 d2 b4 f3 d1 b2 00 00 00 90 98 99 c0 ce d0 a9 d2 e9 00 00 00 f6 db c2 f5 d7 bc f4 d4 b7 f3 d2 b3 69 55 42 1c 94 f7 69 55 42 f6 da c1 f5 d8 bd f5 d6 ba f4 d4 b7 00 00 00 90 98 99 c0 ce d0 9d d0 ee 00 00 00 f7 e0 ca f6 dc c4 f5 d9 be f4 d5 b9 69 55 42 1c 94 f7 69 55 42 f7 df c9 f6 dd c5 f6 da c2 f5 d8 be 00 00 00 90 98 99 c0 ce d0 96 cf f3 00 00 00 f8 e5 d4 f7 e1 cd f6 dd c7 f6 da c1 69 55 42 1c 94 f7 69 55 42 f8 e4 d2 f8 e2 ce f7 df ca f6 dd c6 00 00 00 90 98 99 c0 ce d0 92 d0 f6 00 00 00 fa eb dd f9 e7 d6 f8 e3 d0 f7 df c9 69 55 42 1c 94 f7 69 55 42 fa ea db f9 e7 d7 f8 e5 d3 f8 e2 cf 00 00 00 90 98 99 c0 ce d0 91 cf f7 00 00 00 fb f0 e6 fa ec df f9 e8 d9 f8 e4 d2 69 55 42 1c 94 f7 69 55 42 fb ef e4 fa ed e0 fa ea dc f9 e8 d8 00 00 00 90 98 99 c0 ce d0 91 cf f7 00 00 00 fc f5 ee fc f2 e8 fb ee e2 fa ea db 69 55 42 1c 94 f7 69 55 42 fc f4 ed fc f2 e9 fb f0 e5 fa ed e1 00 00 00 90 98 99 c0 ce d0 91 cf f7 00 00 00 fe fa f6 fd f6 f1 fc f3 eb fb ef e5 69 55 42 1c 94 f7 69 55 42 fd f9 f4 fd f7 f1 fc f5 ed fc f2 ea 00 00 00 90 98 99 c0 ce d0 91 cf f7 00 00 00 ff fd fc fe fb f8 fd f8 f3 fc f4 ed 69 55 42 1c 94 f7 69 55 42 fe fc fa fe fb f8 fd f9 f5 fd f7 f2 00 00 00 90 98 99 c0 ce d0 91 cf f7 00 00 00 ff ff ff ff fe fd fe fc f9 fd f9 f5 69 55 42 1c 94 f7 69 55 42 ff ff ff ff fe fd fe fd fb fe fb f8 00 00 00 90 98 99 c0 ce d0 91 cf f7 69 55 42 69 55 42 69 55 42 69 55 42 69 55 42 69 55 42 69 55 42 69 55 42 69 55 42 69 55 42 69 55 42 69 55 42 69 55 42 a1 ab ad c6 d5 d7 91 cf f7 a9 88 6b ff d8 b7 a9 88 6b a9 88 6b a9 88 6b a9 88 6b a9 88 6b a9 88 6b a9 88 6b a9 88 6b a9 88 6b a9 88 6b a9 88 6b c4 d2 d5 ff 00 ff 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 93 cf f5 9d cf ef ad d2 e6 c4 da e3 ff 00 ff ff 00 ff ff 00 ff

Name=Hist
ProgID=HISTAX.HistAXCtrl.1
Rect=448, 36, 630, 117
Style=50000000h
ID=0
Data=16 01 00 00 01 09 00 00 00 ff ff 00 00 c0 c0 c0 00

Name=btnZoomDown
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=631, 77, 646, 117
Style=50000000h
ID=0
Data=353 0a 01 00 01 00 00 00 00 00 1c 44 3a 5c 49 6d 61 67 65 5c 42 75 74 74 6f 6e 73 5c 41 72 72 6f 77 44 6e 2e 62 6d 70 1c 44 3a 5c 49 6d 61 67 65 5c 42 75 74 74 6f 6e 73 5c 41 72 72 6f 77 44 6e 2e 62 6d 70 01 00 01 00 01 00 00 00 00 06 42 75 74 74 6f 6e 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 3d 00 00 00 0f 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 0d 4d 53 20 53 61 6e 73 20 53 65 72 69 66 00 00 00 00 00 00 00 00 00 05 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 01 00 00 00 01 00 00 00 42 4d 96 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 09 00 00 00 16 00 00 00 01 00 01 00 00 00 00 00 58 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 02 00 00 00 00 00 00 00 ff ff ff 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 f7 80 00 00 e3 80 00 00 c1 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00

Name=btnZoomUp
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=631, 36, 646, 76
Style=50000000h
ID=0
Data=353 0a 01 00 01 00 00 00 00 00 1c 44 3a 5c 49 6d 61 67 65 5c 42 75 74 74 6f 6e 73 5c 41 72 72 6f 77 55 70 2e 62 6d 70 1c 44 3a 5c 49 6d 61 67 65 5c 42 75 74 74 6f 6e 73 5c 41 72 72 6f 77 55 70 2e 62 6d 70 01 00 01 00 01 00 00 00 00 06 42 75 74 74 6f 6e 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 3d 00 00 00 0f 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 0d 4d 53 20 53 61 6e 73 20 53 65 72 69 66 00 00 00 00 00 00 00 00 00 05 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 01 00 00 00 01 00 00 00 42 4d 96 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 09 00 00 00 16 00 00 00 01 00 01 00 00 00 00 00 58 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 02 00 00 00 00 00 00 00 ff ff ff 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 c1 80 00 00 e3 80 00 00 f7 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00

Name=Control223
ProgID=VTDESIGN.VTD3DBarCtrl.1
Rect=443, 31, 703, 123
Style=50000000h
ID=0
Data=72 00 00 00 00 03 00 00 00 03 00 02 00 00 00 05 00 00 80 01 00 00 00 08 00 00 80 00 64 00 00 00 00 00 01 00 01 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 05 41 72 69 61 6c

Name=optKirch
ProgID=VTRADIOBTN.VTRadioBtnCtrl.1
Rect=8, 29, 114, 46
Style=50000000h
ID=0
Data=43 03 00 00 00 01 00 00 00 01 31 ff ff ff ff 01 00 00 00 00 00 00 00 01 00 00 00 04 00 01 00 f5 0a 00 00 c2 01 00 00 40 00 00 00 01

Name=optVariance
ProgID=VTRADIOBTN.VTRadioBtnCtrl.1
Rect=8, 52, 114, 69
Style=50000000h
ID=0
Data=43 03 00 00 00 01 00 00 00 01 32 ff ff ff ff 01 00 00 00 00 00 00 00 01 00 00 00 04 00 01 00 f5 0a 00 00 c2 01 00 00 40 00 00 00 01

Name=optGradient
ProgID=VTRADIOBTN.VTRadioBtnCtrl.1
Rect=8, 75, 114, 92
Style=50000000h
ID=0
Data=43 03 00 00 00 01 00 00 00 01 33 ff ff ff ff 01 00 00 00 00 00 00 00 01 00 00 00 04 00 01 00 f5 0a 00 00 c2 01 00 00 40 00 00 00 01

Name=optLaplas
ProgID=VTRADIOBTN.VTRadioBtnCtrl.1
Rect=8, 98, 114, 115
Style=50000000h
ID=0
Data=43 03 00 00 00 01 00 00 00 01 34 ff ff ff ff 01 00 00 00 00 00 00 00 01 00 00 00 04 00 01 00 f5 0a 00 00 ca 02 00 00 40 00 00 00 01

Name=btn1
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=649, 36, 699, 52
Style=50000000h
ID=2205
Data=142 0c 03 00 01 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 31 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 13 00 00 00 32 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 bc 02 dc 7c 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 0f 00 00 80 00 00 00 00 00 00 00 00 12 00 00 80 12 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 01 00

Name=btn2
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=649, 52, 699, 68
Style=50000000h
ID=2205
Data=142 0c 03 00 01 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 32 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 0e 00 00 00 32 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 bc 02 dc 7c 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 12 00 00 80 12 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 01 00

Name=btn3
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=649, 68, 699, 84
Style=50000000h
ID=2205
Data=135 0a 03 00 01 01 00 00 00 00 00 00 01 00 00 00 01 00 00 00 00 01 33 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 17 00 00 00 32 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 bc 02 dc 7c 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 12 00 00 80 12 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00

Name=btn4
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=649, 100, 699, 116
Style=50000000h
ID=2205
Data=142 0c 03 00 01 01 00 00 00 00 00 00 01 00 00 00 01 00 00 00 00 01 34 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 10 00 00 00 32 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 bc 02 dc 7c 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 12 00 00 80 12 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 01 00

Name=btnAll
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=649, 84, 699, 100
Style=50000000h
ID=2208
Data=167 0c 03 00 01 01 00 00 00 00 00 17 44 3a 5c 56 54 35 52 45 53 5c 69 63 6f 6e 73 5c 72 67 62 2e 62 6d 70 00 00 00 00 01 00 00 00 00 03 41 6c 6c 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 10 00 00 00 32 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 bc 02 dc 7c 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 ff 00 ff 00 00 00 00 00 00 00 00 00 12 00 00 80 12 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 01 00


[Script]
Dim sBrightCaption
Dim StateFit2ImageBeforeForm, StateShowPropertyBeforeForm, StateSendToBeforeForm, StateCutDocBySelBeforeForm 
Dim strFunc	, rec
rec = 0
Const ZoomStep = 0.5
Dim Pane

Dim bSkipEvents			' Флаг для предотвращения повторных действий //
bSkipEvents = True

Dim gl_Script

Sub RunFuncHist(P)
	Select Case P
	    Case 0
			btn1.SetPressedState
			btn2.ResetPressedState
			btn3.ResetPressedState
			btn4.ResetPressedState
			btnAll.ResetPressedState
			Hist.SetPane(0)
	    Case 1
			btn1.ResetPressedState
			btn2.SetPressedState
			btn3.ResetPressedState
			btn4.ResetPressedState
			btnAll.ResetPressedState
			Hist.SetPane(1)
	    Case 2
			btn1.ResetPressedState
			btn2.ResetPressedState
			btn3.SetPressedState
			btn4.ResetPressedState
			btnAll.ResetPressedState
			Hist.SetPane(2)
	    Case 3
			btn1.ResetPressedState
			btn2.ResetPressedState
			btn3.ResetPressedState
			btn4.SetPressedState
			btnAll.ResetPressedState
			Hist.SetPane(3)
	    Case -1
			btnAll.SetPressedState
			btn1.ResetPressedState
			btn2.ResetPressedState
			btn3.ResetPressedState
			btn4.ResetPressedState
			Hist.AddPane(0)
			Hist.AddPane(1)
			Hist.AddPane(2)
	End Select
End Sub

Sub RunFunc()
	optKirch.ItemChecked -1
	optVariance.ItemChecked -1
	optGradient.ItemChecked -1
	optLaplas.ItemChecked -1

	Select Case strFunc	    
	    Case "Kirch"
			optKirch.ItemChecked 0
			edtPower.Visible = True	
			ActionHelper.Kirsch edtPower.ValueInt, chkAdd.Checked
			ActionHelper.Kirsch edtPower.ValueInt, chkAdd.Checked
	    Case "Variance"
			optVariance.ItemChecked 0
			edtPower.Visible = False
			ActionHelper.Variance chkAdd.Checked
			ActionHelper.Variance chkAdd.Checked
	    Case "Gradient"
			optGradient.ItemChecked 0
			edtPower.Visible = False
			ActionHelper.Gradient chkAdd.Checked
			ActionHelper.Gradient chkAdd.Checked
	    Case "Laplas"
			optLaplas.ItemChecked 0
			edtPower.Visible = False
			ActionHelper.Laplas chkAdd.Checked
			ActionHelper.Laplas chkAdd.Checked
	End Select
End Sub

'***************************************************************
'Form event handlers.
'***************************************************************
Sub Form_OnChangePreview()
'здесь ничего нельзя делать из-за рекурсии //
End Sub

Sub Form_OnDestroy()
	Data.SetValue "\DockBars\PageInProcessing", False

	bSkipEvents = True

	ActionState.ResetActionState "RunEdgeDetection"
	ActionManager.ShowDockBars 

	Set f = MainWnd.ActiveFrame
	If TypeName(f) <> "Nothing" Then
		f.GetSplitter.EnableButton -1, -1, 31, 31
	End If
	Set f = Nothing

	'Разблокируем команды в контекстном меню //
	If StateFit2ImageBeforeForm Then ActionState.ResetActionState "Fit2Image"
	If StateShowPropertyBeforeForm Then ActionState.ResetActionState "ShowPropertyBar"
	If StateSendToBeforeForm Then ActionState.ResetActionState "SendTo"
	If StateCutDocBySelBeforeForm Then ActionState.ResetActionState "CutDocBySel"

	Set gl_Script = Nothing
End Sub

Sub Form_OnCancel()
	Form.CancelPreview
End Sub

Sub Form_OnOK()
	rec = 1
	ActionState.BeginGroupUndo "vt"
	Form.ApplyPreview
	ActionManager.SelectMakeVirtual
	ActionState.EndGroupUndo 1
	rec = 0

	If Not Docs.IsPointerNull(MethodMan) Then MethodMan.StartSetValueLogging

	Data.Setvalue "\Filters\EdgFunc", strFunc

	'Запись правильного названия выбранной функции //
	If TypeName (MethodMan) <> "Nothing" Then
		If MethodMan.IsRecording() Then
			sStepName = txtEdgeDet.Text & ": " & Eval( "opt" & strFunc & ".GetItem(0)" )
			MethodMan.RenameCurrentStep sStepName
		End If
	End If

	Data.Setvalue "\Filters\Add", chkAdd.Checked
	Data.Setvalue "\Filters\Power", edtPower.ValueInt 

	'Не запоминаем деление окна если форма не показывется //
	If Data.GetValue ("\FormManager\DisableFormShow") = 0 Then 
		Data.SetValue "\Filters\Edge\SplitWindow", btnSplit.IsPressed
	End If

	If Not Docs.IsPointerNull(MethodMan) Then MethodMan.FinishSetValueLogging

	Data.SetValue "\Form\WasPressOk", 1
End Sub

Sub Form_OnInitialize()
	Set gl_Script = Application.GetGlobalScript("")
	Data.SetValue "\Form\WasPressOk", 0

	sBrightCaption = Docs.LoadString ("Gray")

	txtEdgeDet.Text = Docs.LoadString ("Edge Detection")
	txtSettings.Text = Docs.LoadString ("Settings")
	chkAdd.Caption = Docs.LoadString ("Add to source image")
	edtPower.CaptionText = Docs.LoadString ("Coefficient")

	txtZoom.Text = Docs.LoadString ("Zoom")
	btnSplit.ToolTip = Docs.LoadString ("Split Window")
	btnFitToScreen.ToolTip = Docs.LoadString ("Fit Image to Screen")
	btnZoom0.ToolTip = Docs.LoadString ("Zoom 1:1")

	optKirch.DeleteAll
	optKirch.AddItem Docs.LoadString ("Kirsch")
	optKirch.ReCreate

	optVariance.DeleteAll
	optVariance.AddItem Docs.LoadString ("Variance")
	optVariance.ReCreate

	optGradient.DeleteAll
	optGradient.AddItem Docs.LoadString ("Gradient")
	optGradient.ReCreate

	optLaplas.DeleteAll
	optLaplas.AddItem Docs.LoadString ("Laplace")
	optLaplas.ReCreate

	If Not Docs.IsPointerNull(MethodMan) Then
		If MethodMan.IsRunning() Then
			optKirch.Enabled = False
			optVariance.Enabled = False
			optGradient.Enabled = False
			optLaplas.Enabled = False
		End If
	End If

	Form.InitializePreview
	
	ShowSource
	
	ActionManager.SetBrightnessPanes()
	edtPower.Text = Data.Getvalue ("\Filters\Power")	
	strFunc	= Data.Getvalue ("\Filters\EdgFunc") 
	Execute "opt" & strFunc & ".Enabled = True"
	If Data.Getvalue ("\Filters\Add") Then chkAdd.Checked 1
	ActionState.SetActionState "RunEdgeDetection", 3

	Call set_sldZoom

	Data.SetValue "\DockBars\PageInProcessing", True
	ActionManager.HideDockBars 
	'прорисовываем форму //
	Application.ProcessMessage 0

	'Если форма не показывется, не делим окно //
	If Data.GetValue ("\FormManager\DisableFormShow") = 0 Then
		If Data.GetDefValue ("\Filters\Edge\SplitWindow", 0) Then btnSplit.SetPressedState
	End If
	Call btnSplit_Click()
	Call btnFitToScreen_Click

	RunFuncHist(-1)

	'Блокируем команды в контекстном меню //
	StateFit2ImageBeforeForm = ActionState.GetActionState ("Fit2Image")
	StateShowPropertyBeforeForm = ActionState.GetActionState ("ShowPropertyBar")
	StateSendToBeforeForm = ActionState.GetActionState ("SendTo")
	StateCutDocBySelBeforeForm = ActionState.GetActionState ("CutDocBySel")
	
	If StateFit2ImageBeforeForm Then ActionState.SetActionState "Fit2Image", 0
	If StateShowPropertyBeforeForm Then ActionState.SetActionState "ShowPropertyBar", 0
	If StateSendToBeforeForm Then ActionState.SetActionState "SendTo", 0
	If StateCutDocBySelBeforeForm Then ActionState.SetActionState "CutDocBySel", 0

	bSkipEvents = False
End Sub


'***************************************************************
'edtPower event handlers.
'***************************************************************
Sub edtPower_DataChange()
	If strFunc	= "Kirch" Then RunFunc()
End Sub

'***************************************************************
'Change Function
'***************************************************************
sub optKirch_OnChangeCheck(lItem)
	strFunc = "Kirch"
	Call RunFunc()
end sub

sub optVariance_OnChangeCheck(lItem)
	strFunc = "Variance"
	Call RunFunc()
end sub

sub optGradient_OnChangeCheck(lItem)
	strFunc = "Gradient"
	Call RunFunc()
end sub

sub optLaplas_OnChangeCheck(lItem)
	strFunc = "Laplas"
	Call RunFunc()
end sub

'***************************************************************
'chkAdd event handlers.
'***************************************************************
Sub chkAdd_OnCheck(nCheck)
	RunFunc()	
End Sub

'===============================================================
'
' Zoom
'
'***************************************************************
'sldZoom event handlers.
'***************************************************************
Sub sldZoom_PosChanged()
	Dim frame, s
	Set frame = MainWnd.ActiveFrame
	Set s = frame.GetSplitter	
	
	dZoom = s.GetViewZoom(0,0)
	dNewZoom = Exp(sldZoom.PosLo / 100)
	dz = dNewZoom - dZoom
	cWidth = s.GetViewClientWidth(0,0)
	cHeight = s.GetViewClientHeight(0,0)
	ScrlX = s.GetViewXScroll(0,0)
	ScrlY = s.GetViewYScroll(0,0)
	dX = cWidth * dz * ( ScrlX + s.GetColWidth(0) / 2 ) / ( cWidth * dZoom )
	dY = cHeight * dz * ( ScrlY + s.GetRowHeight(0) / 2 ) / ( cHeight * dZoom )
	s.SetViewZoom 0, 0, dNewZoom
	s.SetViewScroll 0, 0, ScrlX + dX, ScrlY + dY
	edtZoomValue.Text = CStr(Round(dNewZoom * 100, 0)) & "%"
	
	Set s = Nothing
	Set frame = Nothing
End Sub

'***************************************************************
'btnZoom0 event handlers.
'***************************************************************
Sub btnZoom0_Click()
	sldZoom.PosLo = 0
	Call sldZoom_PosChanged()
End Sub

'***************************************************************
'btnFitToScreen event handlers.
'***************************************************************
Sub btnFitToScreen_Click()
	FitDoc2Screen
	Call set_sldZoom
End Sub

'***************************************************************
'btnSplit event handlers.
'***************************************************************
Sub btnSplit_Click()
	bSplitInProcessing = True
	Dim frame, s
	Set frame = MainWnd.ActiveFrame
	If TypeName(frame) <> "Nothing" Then
		Set s = frame.GetSplitter	
		If btnSplit.IsPressed Then
			s.Split 2, 1
			s.ActivateView 0, 0, "ImageDoc.SrcView"
			s.ActivateView 1, 0, "ImageDoc.SrcView"
			SyncZoom 1
		Else
			s.Split 1, 1
			s.ActivateView 0, 0, "ImageDoc.SrcView"
		End If
		s.EnableButton -1, -1, 31, 0
		Set s = Nothing
	End If
	Set frame = Nothing
	
	bSplitInProcessing = False
	RunFunc()
End Sub

'---------------------------------------------------------------
' Установка движка по текущему Zoom //
'---------------------------------------------------------------
Sub set_sldZoom
	Dim frame, s
	Set frame = MainWnd.ActiveFrame
	Set s = frame.GetSplitter	
	sldZoom.PosLo = Log(s.GetViewZoom(0,0)) * 100
	edtZoomValue.Text = CStr(Round(s.GetViewZoom(0,0) * 100, 0)) & "%"
	Set s = Nothing
	Set frame = Nothing
End Sub

'==============================================================
' Устанавливаем активной правую половину окна //
'==============================================================
Sub Docs_OnActivateView(objDoc, nRow, nCol, bActivate)
	Dim frame, s
	If bSkipEvents Then Exit Sub
	Set frame = MainWnd.ActiveFrame
	If TypeName(frame) <> "Nothing" Then
		Set s = frame.GetSplitter
		If s.GetColumnsCount = 2 Then
			If nCol = 0 Then
				s.ActivateView 1, 0, ""
			End If
		End If
	End If
End Sub

'***************************************************************
'btn1 event handlers.
'***************************************************************
Sub btn1_Click()
	RunFuncHist(0)
End Sub
'***************************************************************
'btn2 event handlers.
'***************************************************************
Sub btn2_Click()
	RunFuncHist(1)
End Sub
'***************************************************************
'btn3 event handlers.
'***************************************************************
Sub btn3_Click()
	RunFuncHist(2)
End Sub
'***************************************************************
'btn4 event handlers.
'***************************************************************
Sub btn4_Click()
	RunFuncHist(3)
End Sub
'***************************************************************
'btnAll event handlers.
'***************************************************************
Sub btnAll_Click()
	RunFuncHist(-1)
End Sub

Sub CheckColorModel()
	Set img = Objects.ActiveImage
	If docs.IsPointerNull(img) Then  Exit Sub
	ColorSystem = img.GetColorSystem
	img = nil
	btn1.Visible = True
	btn2.Visible = True
	btn3.Visible = True
	btn4.Visible = False
	Select Case  ColorSystem
		case "RGB"
			btn1.ButtonText = "R"
			btn2.ButtonText = "G"
			btn3.ButtonText = "B"
			btn4.ButtonText = sBrightCaption
			btn4.Visible = True
			btnAll.ButtonText = "RGB"
		case "HSB"
			btn1.ButtonText = "H"
			btn2.ButtonText = "S"
			btn3.ButtonText = "B"
			btnAll.ButtonText = "HSB"
		case "YUV"
			btn1.ButtonText = "Y"
			btn2.ButtonText = "U"
			btn3.ButtonText = "V"
			btnAll.ButtonText = "YUV"
		case "GRAY"
			btn1.Visible = False
			btn2.Visible = False
			btn3.Visible = False
			btnAll.ButtonText = "GRAY"
			RunFuncHist(-1)
	End Select
End Sub

'***************************************************************
'Hist event handlers.
'***************************************************************
Sub Hist_OnNewCalc()
	CheckColorModel()
End Sub


'***************************************************************
'btnZoomUp event handlers.
'***************************************************************
Sub btnZoomUp_Click()
	Hist.ZoomIn(ZoomStep)
End Sub
'***************************************************************
'btnZoomDown event handlers.
'***************************************************************
Sub btnZoomDown_Click()
	Hist.ZoomOut(ZoomStep)
End Sub


'==============================================================
'Обрабатываем рамки и изменение цветовой модели //
'==============================================================
Sub ActionState_OnActionComplete (strActionName, intActionResult)
	Dim objActiveImg, sName
	If strActionName = "MagickStick" _
	  Or strActionName = "SelectRect" Or strActionName = "SelectEllipse" _
	  Or strActionName = "SelectArea" Or strActionName = "SelectInvert" Then
		If intActionResult = 1 Then Call OnChangeSelection()
	ElseIf strActionName = "ConvertImage" Then
		Call OnChangeColorModel()
	ElseIf strActionName = "ObjectDeleteSelection" Then
		Set objActiveImg = Objects.ActiveImage
		If TypeName(objActiveImg.GetParent) <> "Nothing" Then
			sName = objActiveImg.Name
			Set objActiveImg = Nothing
			ObjectDelete sName
		End If
		Call OnChangeSelection()
	End If
End Sub

Sub OnChangeSelection()
	RunFunc()
End Sub

Sub OnChangeColorModel()
	RunFunc()
	CheckColorModel()
	RunFuncHist(-1)
End Sub