[AxForm]
Version=1
Size=429, 366
Title=%Interaction with Database%

[AXControls]
Name=txtBasic
ProgID=VTCONTROLS.VTStaticText.1
Rect=14, 71, 187, 85
Style=50000000h
ID=0
Data=336 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 bc 02 44 42 01 00 06 54 61 68 6f 6d 61 0b 00 00 00 08 00 00 80 0f 00 00 80 0f 00 00 80 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 14 ce f2 ef f0 e0 e2 eb ff f2 fc 2e 2e 2e 20 e2 2e 2e 2e 0d 0a 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 11 00 ff ff ff ff ff ff ff ff 42 4d 36 00 00 00 00 00 00 00 36 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 10 00 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 42 4d 3e 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 01 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff 00 00 00 00 00 01 00 00 00 01 00 00 00 0f 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00

Name=lstObjectFields
ProgID=VTCONTROLS.VTList.1
Rect=16, 89, 415, 237
Style=50000000h
ID=0
Data=2068 00 00 01 00 01 00 00 01 05 56 4c 69 73 74 0a 00 00 00 07 00 00 00 49 4c 01 01 02 00 07 00 04 00 10 00 10 00 ff ff ff ff 05 10 ff ff ff ff ff ff ff ff 42 4d 76 00 00 00 00 00 00 00 76 00 00 00 28 00 00 00 40 00 00 00 20 00 00 00 01 00 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 00 00 80 00 00 00 80 80 00 80 00 00 00 80 00 80 00 80 80 00 00 c0 c0 c0 00 80 80 80 00 00 00 ff 00 00 ff 00 00 00 ff ff 00 ff 00 00 00 ff 00 ff 00 ff ff 00 00 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff ff f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff ff f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff 4f ff ff f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff f4 44 ff ff f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff 44 44 4f ff f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff 44 f4 44 ff f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff 4f ff 44 4f f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff f4 4f f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 4f f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff ff f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff ff f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 42 4d 3e 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 40 00 00 00 20 00 00 00 01 00 01 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 ff ff ff ff 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 03 00 00 00 03 00 ff ff 01 00 0b 00 43 42 61 73 65 43 6f 6c 75 6d 6e 00 00 05 00 00 00 0c 00 00 00 09 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 00 00 02 02 02 4d 53 20 53 61 6e 73 20 53 65 72 69 66 00 00 00 00 00 00 00 0a 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 14 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 ff ff ff 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 ff ff ff ff 01 80 00 00 05 00 00 00 f5 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 cc 03 02 01 22 54 61 68 6f 6d 61 00 20 53 65 72 69 66 00 70 03 28 26 6f 03 f0 57 3f 00 10 9b 70 03 f0 9a 70 03 01 00 00 00 00 00 00 00 0a d2 e8 ef 20 e4 e0 ed ed fb f5 02 00 00 00 b4 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 ff ff ff 00 01 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff ff ff ff ff ff ff ff ff 01 80 00 00 05 00 00 00 f5 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 cc 03 02 01 22 54 61 68 6f 6d 61 00 20 53 65 72 69 66 00 70 03 28 26 6f 03 f0 57 3f 00 10 9b 70 03 f0 9a 70 03 00 00 00 00 00 00 00 00 0b cf ee eb e5 20 e2 20 e1 e0 e7 e5 02 00 00 00 b4 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 ff ff ff 00 01 00 00 00 00 00 00 00 05 00 00 00 ff ff ff ff ff ff ff ff ff ff ff ff 0e 00 00 80 0d 00 00 80 05 00 00 80 ff ff ff 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 05 56 4c 69 73 74 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

Name=lstConstants
ProgID=VTCONTROLS.VTList.1
Rect=16, 254, 415, 328
Style=50000000h
ID=0
Data=2067 00 00 01 00 01 01 00 01 05 56 4c 69 73 74 0a 00 00 00 07 00 00 00 49 4c 01 01 02 00 07 00 04 00 10 00 10 00 ff ff ff ff 05 10 ff ff ff ff ff ff ff ff 42 4d 76 00 00 00 00 00 00 00 76 00 00 00 28 00 00 00 40 00 00 00 20 00 00 00 01 00 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 00 00 80 00 00 00 80 80 00 80 00 00 00 80 00 80 00 80 80 00 00 c0 c0 c0 00 80 80 80 00 00 00 ff 00 00 ff 00 00 00 ff ff 00 ff 00 00 00 ff 00 ff 00 ff ff 00 00 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff ff f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff ff f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff 4f ff ff f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff f4 44 ff ff f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff 44 44 4f ff f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff 44 f4 44 ff f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff 4f ff 44 4f f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff f4 4f f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 4f f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff ff f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff ff f0 00 00 ff ff ff ff ff f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 42 4d 3e 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 40 00 00 00 20 00 00 00 01 00 01 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 80 03 80 03 00 00 00 00 ff ff ff ff 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 03 00 00 00 03 00 ff ff 01 00 0b 00 43 42 61 73 65 43 6f 6c 75 6d 6e 00 00 05 00 00 00 0c 00 00 00 09 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 00 00 02 02 02 4d 53 20 53 61 6e 73 20 53 65 72 69 66 00 00 00 00 00 00 00 0a 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 14 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 ff ff ff 00 01 00 00 00 ff ff ff 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 ff ff ff ff 01 80 00 00 05 00 00 00 f5 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 cc 03 02 01 22 54 61 68 6f 6d 61 00 20 53 65 72 69 66 00 70 03 28 26 6f 03 f0 57 3f 00 10 9b 70 03 f0 9a 70 03 00 00 00 00 00 00 00 00 09 ca ee ed f1 f2 e0 ed f2 e0 02 00 00 00 b4 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 ff ff ff 00 01 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff ff ff ff ff ff ff ff ff 01 80 00 00 05 00 00 00 f5 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 cc 03 02 01 22 54 61 68 6f 6d 61 00 55 6e 69 63 6f 64 65 20 4d 53 00 00 00 0a 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0b cf ee eb e5 20 e2 20 e1 e0 e7 e5 02 00 00 00 b4 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 ff ff ff 00 01 00 00 00 00 00 00 00 05 00 00 00 ff ff ff ff ff ff ff ff ff ff ff ff 07 00 00 80 0e 00 00 80 05 00 00 80 02 00 00 80 0e 00 00 80 01 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 05 56 4c 69 73 74 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

Name=txtDBCaption
ProgID=VTCONTROLS.VTStaticText.1
Rect=15, 10, 89, 25
Style=50000000h
ID=0
Data=327 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 0b 00 00 00 08 00 00 80 0f 00 00 80 0f 00 00 80 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0b c1 e0 e7 e0 20 e4 e0 ed ed fb f5 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 11 00 ff ff ff ff ff ff ff ff 42 4d 36 00 00 00 00 00 00 00 36 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 10 00 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 42 4d 3e 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 01 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff 00 00 00 00 00 01 00 00 00 01 00 00 00 0f 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00

Name=txtDBPath
ProgID=VTCONTROLS.VTStaticText.1
Rect=20, 29, 381, 47
Style=50000000h
ID=0
Data=316 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 0b 00 00 00 08 00 00 80 0f 00 00 80 0f 00 00 80 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 11 00 ff ff ff ff ff ff ff ff 42 4d 36 00 00 00 00 00 00 00 36 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 10 00 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 42 4d 3e 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 01 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff 00 00 00 00 00 01 00 00 00 01 00 00 00 0f 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00

Name=Control351
ProgID=VTDESIGN.VTD3DBarCtrl.1
Rect=8, 17, 419, 61
Style=58000000h
ID=0
Data=72 00 00 00 00 03 00 00 00 03 00 02 00 00 00 05 00 00 80 01 00 00 00 08 00 00 80 00 64 00 00 00 00 00 01 00 01 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 05 41 72 69 61 6c

Name=btnChangeDB
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=387, 28, 407, 48
Style=50000000h
ID=0
Data=144 0c 01 00 01 00 00 00 00 00 00 00 01 00 01 00 01 00 00 00 00 03 2e 2e 2e 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 04 01 01 14 00 00 00 14 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 05 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 01 00

Name=chkActivateDB
ProgID=VTCHECKBOX.VTCheckBoxCtrl.1
Rect=21, 56, 236, 75
Style=40000000h
ID=0
Data=129 00 00 00 00 04 00 00 00 00 00 00 00 1a c0 ea f2 e8 e2 e8 e7 e8 f0 ee e2 e0 f2 fc 20 ef f0 e8 20 ef ee f1 fb eb ea e5 08 00 00 80 0f 00 00 80 08 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61

Name=chkCreateNewRecord
ProgID=VTCHECKBOX.VTCheckBoxCtrl.1
Rect=21, 336, 236, 356
Style=50000000h
ID=0
Data=125 00 00 00 00 04 00 00 00 00 00 00 00 16 d1 ee e7 e4 e0 e2 e0 f2 fc 20 ed ee e2 f3 fe 20 e7 e0 ef e8 f1 fc 08 00 00 80 0f 00 00 80 08 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61


[Script]
Const cName = 0
Const cType = 1
Const cDBName = 2
Dim sForgetSetFields, sAttention, sNoSelectField
Dim sCantSendToNumber, sCantSendToDateTime, sNotCorrectNumber, sNotCorrectDate, sInputConstText

Dim strFormOptSec

Dim arrDBFields()
Dim arrDBInfo()
Dim arrListCombo()	' список значений combo дл€ vtlst //
Dim iFieldsCount
Dim arrDefFields()

Dim strDBSecAss
Dim strDBSecAssConst
Dim strDBSecAssSend
Dim strDBSecFieldsInfo
Dim strDBSecVTTypes
Dim strDBSecCaptions

Dim strDBPath, strDbd
Dim objDBDoc, objDBData

Dim gl_Script

'***************************************************************
'Form event handlers.
'***************************************************************
Sub Form_OnInitialize()
	Set gl_Script = Application.GetGlobalScript("")

	sForgetSetFields = Docs.LoadString ("You have not specified fields for interaction with database!")
	sAttention = Docs.LoadString ("Attention")
	sNoSelectField = Docs.LoadString ("Field is not selected!")
	sCantSendToNumber = Docs.LoadString ("Text cannot be sent to numeric field!\nInput numeric value.")
	sCantSendToDateTime = Docs.LoadString ("Text cannot be sent to date field!\nInput value in date format.")
	sNotCorrectNumber = Docs.LoadString ("Text cannot be sent to numeric field!\nInput numeric value.")
	sNotCorrectDate = Docs.LoadString ("Text cannot be sent to date field!\nInput value in date format.")
	sInputConstText = Docs.LoadString ("Input constant field value!")

	txtDBCaption.Text = Docs.LoadString ("Database")
	chkActivateDB.Caption = Docs.LoadString ("Activate when sending")
	chkCreateNewRecord.Caption = Docs.LoadString ("Create new record")
	txtBasic.Text = Docs.LoadString ("Send")
	lstObjectFields.SetColumnCaption 1, Docs.LoadString ("Data Type")
	lstObjectFields.SetColumnCaption 2, Docs.LoadString ("Database Field")
	lstConstants.SetColumnCaption 1, Docs.LoadString ("Constant Value")
	lstConstants.SetColumnCaption 2, Docs.LoadString ("Database Field")
	
	strDBPath = Data.GetDefValue("\Settings\DB\Database", "")
	txtDBPath.Text = " " & strDBPath

	strDbd = gl_Script.GetFileNameExt( strDBPath )
	If strDbd = "" Then strDbd = "Default"
	strDBSecAss = "\Settings\DBLinks\" & strDbd & "\Relations\"
	strDBSecAssConst = "\Settings\DBLinks\" & strDbd & "\Constants\"
	strDBSecAssSend = "\Settings\DBLinks\" & strDbd & "\SendStates\"
	strDBSecFieldsInfo = "\RecordNamedData\FieldsInfo\"
	strDBSecVTTypes = "\DBase\DBaseSettings\VTObjectTypes\"
	strDBSecCaptions = "\DBase\DBaseSettings\Tables_Captions\"


	'If Data.GetDefValue("\Settings\DB\ActivateDatabase", 1) Then chkActivateDB.Checked 1

	If Data.GetDefValue("\Settings\DB\SendToNewDBRecord", 1) Then chkCreateNewRecord.Checked 1
	'If Data.GetDefValue ("\tmp\OptionsDB\OptionsMode", 0) Then chkCreateNewRecord.Visible = False
	'If Not MethodMan.IsRunning Then chkCreateNewRecord.Visible = False

	strFormOptSec = "\OptionsDB\"

	iFieldsCount = Data.GetDefValue(strFormOptSec & "DefFieldsCount", 0)
	ReDim arrDefFields(iFieldsCount, 2)
	For i = 1 To iFieldsCount
		strName = Data.GetValue(strFormOptSec & "DefFieldName" & CStr(i))
		strType = Data.GetValue(strFormOptSec & "DefFieldType" & CStr(i))
		strDBName = Data.GetValue(strFormOptSec & "DefFieldDBName" & CStr(i))
		If strName = "" Or strType = "" Then
			iFieldsCount = i - 1
			Data.SetValue strFormOptSec & "DefFieldsCount", iFieldsCount
			ReDim Preserve arrDefFields(iFieldsCount, 2)
			Exit For
		End If
		arrDefFields(i, cName) = strName
		arrDefFields(i, cType) = strType
		arrDefFields(i, cDBName) = strDBName
	Next

	If iFieldsCount = 0 Then
	ElseIf iFieldsCount = 1 Then
	ElseIf iFieldsCount = 2 Then
	Else
		txtBasic.Visible = True
		lstObjectFields.Visible = True
	End If

	Call read_db
End Sub

Sub Form_OnDestroy()
	Set objDBDoc = Nothing
	Set objDBData = Nothing
	Set gl_Script = Nothing
End Sub

Sub Form_OnOK()
	'пишем в шаг методики // 
	If Not Docs.IsPointerNull(MethodMan) Then MethodMan.StartSetValueLogging

	For i = 0 To iFieldsCount - 1
		Data.SetValue strDBSecAss & arrDefFields(i + 1, cDBName), _
		  seek_in_dbd( arrDefFields(i + 1, cType), lstObjectFields.GetCellAsString(2, i) )
		Data.SetValue strDBSecAssSend & arrDefFields(i + 1, cDBName), _
		  lstObjectFields.GetCellAsLogical(0, i)
	Next
	
	For i = 0 To lstConstants.GetRowCount - 1
		sConstName = "Const" & CStr(i + 1)
		Data.SetValue strDBSecAssConst & sConstName & "_Value", lstConstants.GetCellAsString(1, i)
		Data.SetValue strDBSecAssConst & sConstName, _
		  seek_in_dbd( "BaseDB", lstConstants.GetCellAsString(2, i) )
		Data.SetValue strDBSecAssSend & sConstName, lstConstants.GetCellAsLogical(0, i)
	Next

	If Not Docs.IsPointerNull(objDBDoc) Then objDBDoc.SetModifiedFlag True

	Data.SetValue "\Settings\DB\Database", Trim(txtDBPath.Text)
	'Data.SetValue "\Settings\DB\ActivateDatabase", Abs(chkActivateDB.Checked)
	Data.SetValue "\Settings\DB\SendToNewDBRecord", Abs(chkCreateNewRecord.Checked)

	'закончили писать в шаг методики //
	If Not Docs.IsPointerNull(MethodMan) Then MethodMan.FinishSetValueLogging

	Data.SetValue "\tmpDB\OptionsDBMaster_OK", 1
End Sub

Sub Form_OnCancel()
	Data.SetValue "\tmpDB\OptionsDBMaster_OK", 0
End Sub


'========================================================================================
' „тение информации о пол€х в dbd и заполнение VTList-ов объектов и констант //
' ≈сли база, прописанна€ в методике открыта, читаетс€ информаци€ из запроса - //
' отбрасываютс€ недоступные или несуществуюшие пол€ (при их выборе строка становитс€ серой) //
' ≈сли база не открыта, читаетс€ обща€ информаци€ - недоступные пол€ не помечаютс€ //
'========================================================================================
Sub read_db
	Set objDBDoc = gl_Script.GetDocByName("Database", strDBPath)
	If TypeName(objDBDoc) <> "Nothing" Then
		Set objDBData = objDBDoc.GetData()
	Else
		If strDBPath <> "" Then
			Set objDBData = CreateObject( "Data.NamedData" )
			If objDBData.ReadFile (strDBPath) = 0 Then Set objDBData = Nothing
		Else
			Set objDBData = Nothing
		End If
	End If
	'MsgBox "read_db"

	For i = 0 To lstObjectFields.GetRowCount
		lstObjectFields.DeleteRow 0
	Next
	For i = 0 To lstConstants.GetRowCount
		lstConstants.DeleteRow 0
	Next

	If TypeName(objDBData) = "Nothing" Then
		'MsgBox "no dbd!"
		Form.EnableButtons 0 + 2 + 8 + 16
		Exit Sub
	End If

	Call ReadFieldsInfo

	objDBData.SetSection strDBSecVTTypes
	intEntriesCount = objDBData.GetEntriesCount
	ReDim arrDBFields (2, intEntriesCount - 1)
	For i = 0 To intEntriesCount - 1
		objDBData.SetSection strDBSecVTTypes
		strEntryName = objDBData.GetEntryName(i)
		pos = InStr(strEntryName, ".")
		If pos > 0 Then
			strTable = Left(strEntryName, pos - 1)
			strField = Mid(strEntryName, pos + 1)
		Else
			strTable = strEntryName
			strField = ""
		End If
		arrDBFields(0, i) = strField	'Field Name
		arrDBFields(1, i) = objDBData.GetValue(strDBSecCaptions & strTable & "." & strField) 'Caption
		strVTtype = objDBData.GetValue(strDBSecVTTypes & strEntryName)
		If strField = arrDBFields(1, i) And i = 0 Then
			arrDBFields(2, i) = "PrimaryKey"
		Else
			Select Case strVTtype
			  Case "Image"
				arrDBFields(2, i) = strVTtype
			  Case "Object List"
				arrDBFields(2, i) = strVTtype
			  Case "OleObject"
				arrDBFields(2, i) = strVTtype
			  Case "StatTable"
				arrDBFields(2, i) = strVTtype
			  Case "StatObject"
				arrDBFields(2, i) = strVTtype
			  Case Else
				arrDBFields(2, i) = "BaseDB"	'String, Number, DateTime
			End Select
		End If
	Next

	' набиваем комбо дл€ второго пол€ объектов //
	If iFieldsCount = 2 Then
	End If

	'  //
	For k = 1 To iFieldsCount
		strField = Data.GetValue(strDBSecAss & arrDefFields(k, cDBName))
'		MsgBox strDBSecAss & arrDefFields(k, cDBName) & " => " & strField
		
		lstObjectFields.AddRow(k)
		lstObjectFields.SetCellAsLogical 0, k - 1, Data.GetValue(strDBSecAssSend & arrDefFields(k, cDBName))
		lstObjectFields.SetCellValue 1, k - 1, arrDefFields(k, cName)
'		MsgBox arrDefFields(k, cName)
		lstObjectFields.ClearCombo 2, k - 1
		strComboSel = "---"
		lstObjectFields.AddComboString 2, k - 1, strComboSel
		
		j = 1
		For i = 0 To UBound(arrDBFields, 2)
			If arrDBFields(2, i) = arrDefFields(k, cType) Then
				lstObjectFields.AddComboString 2, k - 1, arrDBFields(1, i)
'				MsgBox LCase(Trim(arrDBFields(1, i))) & " = " & strField 
				If arrDBFields(0, i) = strField Then
					strComboSel = arrDBFields(1, i)
				Else
					If j = 1 Then strFirstCombo = arrDBFields(1, i)
				End If
				j = j + 1
			End If
		Next

		lstObjectFields.SetCellValue 2, k - 1, strComboSel
		
		'если взаимодействие не определено, выбираем первое поле из списка //
		'при условии, что оно еще не выбрано //
		If strField = "" Then
			If j > 1 Then
				bUnique = True
				For i = 0 To k - 2
					If lstObjectFields.GetCellAsString(2, i) = strFirstCombo Then bUnique = False
				Next
				If bUnique Then lstObjectFields.SetCellValue 2, k - 1, strFirstCombo
			End If
		End If

		Call lstObjectFields_DataChange(2, k - 1)
	Next

	' заполн€ем VTList констант //
	For k = 1 To 3	'3 константы //
		strField = Data.GetDefValue( strDBSecAssConst & "Const" & CStr(k), "" )
		
		lstConstants.AddRow(k)
		sValue = Data.GetDefValue( strDBSecAssConst & "Const" & CStr(k) & "_Value", "" )
		If sValue = "" Then
			lstConstants.SetCellAsLogical 0, k - 1, 0
		Else
			lstConstants.SetCellAsLogical 0, k - 1, Data.GetValue(strDBSecAssSend & "Const" & CStr(k))
		End If

		lstConstants.ClearCombo 2, k - 1
		lstConstants.AddComboString 2, k - 1, "---"
		
		lstConstants.SetCellValue 2, k - 1, "---"
		For i = 0 To UBound(arrDBFields, 2)
			If arrDBFields(2, i) = "BaseDB" Then
				lstConstants.AddComboString 2, k - 1, arrDBFields(1, i)
				If Trim(arrDBFields(0, i)) = strField Then lstConstants.SetCellValue 2, k - 1, arrDBFields(1, i)
			End If
		Next

		sFieldCaption = lstConstants.GetCellAsString(2, k - 1)
		If sFieldCaption <> "---" Then
			sFindField = check_field( "BaseDB", sFieldCaption )
			If sFindField = "" Or sFindField = "no reference" Then
				sValue = ""
			End If
		End If
		lstConstants.SetCellValue 1, k - 1, sValue
		
		Call lstConstants_DataChange(2, k - 1)
	Next
End Sub


'===============================================================
'ѕоиск имени пол€ по его типу и заголовку //
' !!! поиск производитс€ в общей информации, где могут быть левые данные //
'===============================================================
Function seek_in_dbd(sType, sCaption)
	seek_in_dbd = "---"
	For i = 0 To UBound(arrDBFields, 2)
		If sCaption = arrDBFields(1, i) And sType = arrDBFields(2, i) Then
			seek_in_dbd = arrDBFields(0, i)
			Exit Function
		End If
	Next
End Function


'***************************************************************
'btnChangeDB event handlers.
'***************************************************************
sub btnChangeDB_Click()
	Dim strLastTemplate, strLastExt, strFile
	strLastTemplate = Data.GetValue("\FileOpenDialog\FilterTemplate")
	strLastExt = Data.GetValue("\FileOpen\LastExt")
	Data.SetValue "\FileOpenDialog\FilterTemplate", "dbd"
	Data.SetValue "\FileOpen\LastExt", ".dbd"
	strFile = Application.DoOpenFileDialog ("", "")
	Data.SetValue "\FileOpenDialog\FilterTemplate", strLastTemplate
	Data.SetValue "\FileOpen\LastExt", strLastExt
	
	If strFile <> "" Then
		strDBPath = strFile
		txtDBPath.Text = " " & strDBPath

		strDbd = gl_Script.GetFileNameExt( strDBPath )
		strDBSecAss = "\Settings\DBLinks\" & strDbd & "\Relations\"
		strDBSecAssConst = "\Settings\DBLinks\" & strDbd & "\Constants\"
		strDBSecAssSend = "\Settings\DBLinks\" & strDbd & "\SendStates\"

		Call read_db
	End If
	'If strFile <> "" Then ActionManager.FileOpen strFile
end sub

'***************************************************************
'lstObjectFields event handlers.
'***************************************************************
sub lstObjectFields_DataChange(nColumn, nRow)
	If nColumn = 0 Then
		If lstObjectFields.GetCellAsString(2, nRow) = "---" Then
			MsgBox sNoSelectField, vbExclamation, gl_Script.sVT
			lstObjectFields.SetCellAsLogical 0, nRow, 0
		End If
	ElseIf nColumn = 2 Then
		sField = lstObjectFields.GetCellAsString(2, nRow)
		If check_field( arrDefFields(nRow + 1, cType), sField ) <> "" Then
			Call set_row_font_color( lstObjectFields, nRow, "(0, 0, 0)" )
		Else
			Call set_row_font_color( lstObjectFields, nRow, "(150, 150, 150)" )
		End If
		If sField = "---" Then
			lstObjectFields.SetCellAsLogical 0, nRow, 0
		End If
	End If

	bOk = 0
	For i = 0 To lstObjectFields.GetRowCount - 1
		If lstObjectFields.GetCellAsLogical(0, i) = 1 Then bOk = 1
	Next
	Form.EnableButtons bOk + 2 + 8 + 16
end sub

'***************************************************************
'lstConstants event handlers.
'***************************************************************
sub lstConstants_DataChange(nColumn, nRow)
	Dim sField
	Dim sType
	Dim sFieldName
	Dim sNewText

	If nColumn = 0 Then
		If lstConstants.GetCellAsString(2, nRow) = "---" Then
			MsgBox sNoSelectField, vbExclamation, gl_Script.sVT
			lstConstants.SetCellAsLogical 0, nRow, 0
		End If
		If lstConstants.GetCellAsLogical(0, nRow) Then
			If Trim( lstConstants.GetCellAsString(1, nRow) ) = "" Then
				MsgBox sInputConstText, vbExclamation, gl_Script.sVT
				lstConstants.SetCellAsLogical 0, nRow, 0
			End If
		End If
	ElseIf nColumn = 1 Then
		sNewText = Trim( lstConstants.GetCellAsString(1, nRow) )
		sType = "BaseDB"
		sField = lstConstants.GetCellAsString(2, nRow)
		sFieldName = check_field( sType, sField )
		Select Case sType
		  Case "Number"
			If Not IsNumeric(sNewText) Then
				MsgBox sNotCorrectNumber, vbExclamation, gl_Script.sVT
				lstConstants.SetCellValue 1, nRow, ""
				sNewText = ""
			End If
		  Case "DateTime"
			If Not IsDate(sNewText) Then
				MsgBox sNotCorrectDate, vbExclamation, gl_Script.sVT
				lstConstants.SetCellValue 1, nRow, ""
				sNewText = ""
			End If
		End Select

		If sNewText = "" Then
			lstConstants.SetCellAsLogical 0, nRow, 0
		Else
			If lstConstants.GetCellAsString(2, nRow) = "---" Then
				lstConstants.SetCellAsLogical 0, nRow, 0
			Else
				lstConstants.SetCellAsLogical 0, nRow, 1
			End If
		End If
	ElseIf nColumn = 2 Then
		sField = lstConstants.GetCellAsString(2, nRow)
		sType = "BaseDB"
		sFieldName = check_field( sType, sField )
		If sFieldName <> "" And sFieldName <> "no reference" Then
			Call set_row_font_color( lstConstants, nRow, "(0, 0, 0)" )
			
			Dim sConstText
			sConstText = lstConstants.GetCellAsString(1, nRow)
			bInputConst = vbAbort
			If sConstText <> "" Then
				If sType = "Number" And Not IsNumeric( sConstText ) Then
					bInputConst = MsgBox (sCantSendToNumber, vbExclamation + vbOkCancel, gl_Script.sVT)
				ElseIf sType = "DateTime" And Not IsDate( sConstText ) Then
					bInputConst = MsgBox (sCantSendToDateTime, vbExclamation + vbOkCancel, gl_Script.sVT)
				End If
				If bInputConst = vbOk Then
					lstConstants.SetCellValue 1, nRow, ""
					lstConstants.SetCurentCol 1
					lstConstants.SetCellAsLogical 0, nRow, 0
				ElseIf bInputConst = vbCancel Then
					lstConstants.SetCellValue 2, nRow, "---"
				End If
			End If
		Else
			Call set_row_font_color( lstConstants, nRow, "(150, 150, 150)" )
		End If
		If lstConstants.GetCellAsString(2, nRow) = "---" Then
			lstConstants.SetCellAsLogical 0, nRow, 0
			Call set_row_font_color( lstConstants, nRow, "(150, 150, 150)" )
		End If
	End If
end sub

'===============================================================
'”становка цвета фона и текста всей строки //
'===============================================================
Sub set_row_back_color(objVTList, nRow, sColor)
	If Docs.IsPointerNull(objVTList) Then Exit Sub
	binColor = gl_Script.ConvertColorStrToBin(sColor)
	For i = 0 To objVTList.GetColumnCount - 1
		objVTList.SetCellBackColor i, nRow, binColor
	Next
End Sub

Sub set_row_font_color(objVTList, nRow, sColor)
	If Docs.IsPointerNull(objVTList) Then Exit Sub
	binColor = gl_Script.ConvertColorStrToBin(sColor)
	For i = 0 To objVTList.GetColumnCount - 1
		objVTList.SetCellForeColor i, nRow, binColor
	Next
End Sub

'===============================================================
'ѕровер€ет наличие пол€ в активном запросе //
'	In:  sType, sName - тип и им€ пол€ //
'	Out: sType - уточненный тип пол€ (только дл€ String, Number и DateTime) //
'	     "" - поле отсутствует в запросе //
'	     "no reference" - дл€ данного типа выбранно "---" //
'	     "no info" - база не открыта, поэтому нет информации о запросе //
'===============================================================
Function check_field( ByRef sType, sName )
	check_field = ""
	n = UBound(arrDBInfo, 2)
	If n = -1 Then check_field = "no info"
	If sName = "---" Then
		check_field = "no reference"
		Exit Function
	End If
	For i = 0 To n
		If arrDBInfo(1, i) = sName Then
			If sType = "BaseDB" Then
				If arrDBInfo(2, i) = "String" _
				  Or arrDBInfo(2, i) = "Number" _
				  Or arrDBInfo(2, i) = "DateTime" Then
					check_field = arrDBInfo(0, i)
					sType = arrDBInfo(2, i)
					Exit Function
				End If
			Else
				If arrDBInfo(2, i) = sType Then
					check_field = arrDBInfo(0, i)
					Exit Function
				End If
			End If
		End If
	Next
End Function

Sub ReadFieldsInfo
	If Docs.IsPointerNull(objDBData) Then Exit Sub
	 	
	objDBData.SetSection strDBSecFieldsInfo
	intInfoCount = objDBData.GetEntriesCount
	ReDim arrDBInfo (2, intInfoCount - 1)
	For i = 0 To intInfoCount - 1
		objDBData.SetSection strDBSecFieldsInfo
		strEntryName = objDBData.GetEntryName(i)
		strFieldEntry = strDBSecFieldsInfo & strEntryName
		strTable = objDBData.GetValue(strFieldEntry & "\Table")
		arrDBInfo(0, i) = objDBData.GetValue(strFieldEntry & "\Field")
		arrDBInfo(1, i) = objDBData.GetValue(strDBSecCaptions & strTable & "." & arrDBInfo(0, i))
		strType = objDBData.GetValue(strFieldEntry & "\Type")
		If strType = "PrimaryKey" Then
			arrDBInfo(2, i) = strType
		ElseIf strType = "VTObject" Then
			arrDBInfo(2, i) = objDBData.GetValue(strFieldEntry & "\VTtype")
		ElseIf strType = "String" Then
			arrDBInfo(2, i) = strType
		ElseIf strType = "Number" Then
			arrDBInfo(2, i) = strType
		ElseIf strType = "DateTime" Then
			arrDBInfo(2, i) = strType
		Else
			arrDBInfo(2, i) = ""
		End If
	Next
End Sub


