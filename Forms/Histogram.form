[AxForm]
Version=1
Size=393, 145
Title=%Histogram%

[AXControls]
Name=Hist
ProgID=HISTAX.HistAXCtrl.1
Rect=5, 3, 296, 132
Style=50000000h
ID=2201
Data=16 01 00 00 01 09 00 00 00 ff ff 00 00 93 94 96 00

Name=btnAll
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=325, 99, 375, 122
Style=50000000h
ID=2208
Data=160 0a 03 00 01 01 00 00 00 00 00 17 44 3a 5c 56 54 35 52 45 53 5c 69 63 6f 6e 73 5c 72 67 62 2e 62 6d 70 00 00 00 00 01 00 00 00 00 03 41 6c 6c 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 17 00 00 00 32 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 bc 02 dc 7c 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 ff 00 ff 00 00 00 00 00 00 00 00 00 12 00 00 80 12 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00

Name=Control187
ProgID=VTDESIGN.VTD3DBarCtrl.1
Rect=316, 1, 383, 133
Style=58000000h
ID=123
Data=73 00 00 00 00 03 00 00 00 03 00 02 00 00 00 ff ff ff 00 01 00 00 00 00 00 00 00 00 64 00 00 00 00 00 01 00 01 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61

Name=ZoomDown
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=258, 73, 296, 135
Style=40000000h
ID=0
Data=141 0a 01 00 01 00 00 00 00 00 00 00 01 00 01 00 01 00 00 00 00 04 44 6f 77 6e 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 3e 00 00 00 26 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 02 00 00 90 01 3c 67 02 00 09 57 69 6e 67 64 69 6e 67 73 00 00 00 00 00 00 00 00 00 05 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00

Name=ZoomUp
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=263, 1, 301, 56
Style=40000000h
ID=0
Data=139 0a 01 00 01 00 00 00 00 00 00 00 01 00 01 00 01 00 00 00 00 02 55 70 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 37 00 00 00 26 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 02 00 00 90 01 40 7e 05 00 09 57 69 6e 67 64 69 6e 67 73 00 00 00 00 00 00 00 00 00 05 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00

Name=btnZoomUp
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=298, 4, 313, 65
Style=50000000h
ID=0
Data=353 0a 01 00 01 00 00 00 00 00 1c 44 3a 5c 49 6d 61 67 65 5c 42 75 74 74 6f 6e 73 5c 41 72 72 6f 77 55 70 2e 62 6d 70 1c 44 3a 5c 49 6d 61 67 65 5c 42 75 74 74 6f 6e 73 5c 41 72 72 6f 77 55 70 2e 62 6d 70 01 00 01 00 01 00 00 00 00 06 42 75 74 74 6f 6e 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 3d 00 00 00 0f 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 0d 4d 53 20 53 61 6e 73 20 53 65 72 69 66 00 00 00 00 00 00 00 00 00 05 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 01 00 00 00 01 00 00 00 42 4d 96 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 09 00 00 00 16 00 00 00 01 00 01 00 00 00 00 00 58 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 02 00 00 00 00 00 00 00 ff ff ff 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 c1 80 00 00 e3 80 00 00 f7 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00

Name=btnZoomDown
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=298, 68, 313, 129
Style=50000000h
ID=0
Data=353 0a 01 00 01 00 00 00 00 00 1c 44 3a 5c 49 6d 61 67 65 5c 42 75 74 74 6f 6e 73 5c 41 72 72 6f 77 44 6e 2e 62 6d 70 1c 44 3a 5c 49 6d 61 67 65 5c 42 75 74 74 6f 6e 73 5c 41 72 72 6f 77 44 6e 2e 62 6d 70 01 00 01 00 01 00 00 00 00 06 42 75 74 74 6f 6e 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 3d 00 00 00 0f 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 0d 4d 53 20 53 61 6e 73 20 53 65 72 69 66 00 00 00 00 00 00 00 00 00 05 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 01 00 00 00 01 00 00 00 42 4d 96 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 09 00 00 00 16 00 00 00 01 00 01 00 00 00 00 00 58 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 02 00 00 00 00 00 00 00 ff ff ff 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 f7 80 00 00 e3 80 00 00 c1 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00 ff 80 00 00

Name=btn4
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=325, 74, 375, 95
Style=50000000h
ID=2205
Data=142 0c 03 00 01 01 00 00 00 00 00 00 01 00 00 00 01 00 00 00 00 01 34 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 17 00 00 00 32 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 bc 02 dc 7c 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 12 00 00 80 12 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 01 00

Name=btn3
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=325, 52, 375, 73
Style=50000000h
ID=2205
Data=135 0a 03 00 01 01 00 00 00 00 00 00 01 00 00 00 01 00 00 00 00 01 33 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 17 00 00 00 32 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 bc 02 dc 7c 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 12 00 00 80 12 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00

Name=btn2
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=325, 30, 375, 51
Style=50000000h
ID=2205
Data=135 0a 03 00 01 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 32 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 17 00 00 00 32 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 bc 02 dc 7c 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 12 00 00 80 12 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00

Name=btn1
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=325, 8, 375, 29
Style=50000000h
ID=2205
Data=135 0a 03 00 01 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 31 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 17 00 00 00 32 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 bc 02 dc 7c 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 0f 00 00 80 00 00 00 00 00 00 00 00 12 00 00 80 12 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00


[Script]
Dim sBrightCaption
Const ZoomStep = 0.5
Dim Pane

'***************************************************************
'Language initializing
'***************************************************************
Form.Title = Docs.LoadString ("Histogram")

Sub RunFunc(P)
	Select Case P
	    Case 0
			btn1.SetPressedState
			btn2.ResetPressedState
			btn3.ResetPressedState
			btn4.ResetPressedState
			btnAll.ResetPressedState
			Hist.SetPane(0)
	    Case 1
			btn1.ResetPressedState
			btn2.SetPressedState
			btn3.ResetPressedState
			btn4.ResetPressedState
			btnAll.ResetPressedState
			Hist.SetPane(1)
	    Case 2
			btn1.ResetPressedState
			btn2.ResetPressedState
			btn3.SetPressedState
			btn4.ResetPressedState
			btnAll.ResetPressedState
			Hist.SetPane(2)
	    Case 3
			btn1.ResetPressedState
			btn2.ResetPressedState
			btn3.ResetPressedState
			btn4.SetPressedState
			btnAll.ResetPressedState
			Hist.SetPane(3)
	    Case -1
			btnAll.SetPressedState
			btn1.ResetPressedState
			btn2.ResetPressedState
			btn3.ResetPressedState
			btn4.ResetPressedState
			Hist.AddPane(0)
			Hist.AddPane(1)
			Hist.AddPane(2)
	End Select
End Sub
'***************************************************************
'Form event handlers.
'***************************************************************
Sub Form_OnShow()
	Hist.SetTarget(Objects.ActiveImage)
End Sub

Sub Form_OnChangePreview()
	CheckColorModel()
	RunFunc(-1)
End Sub

Sub Form_OnInitialize()
	sBrightCaption = Docs.LoadString ("Gray")
	RunFunc(-1)
End Sub
'***************************************************************
'btn1 event handlers.
'***************************************************************
Sub btn1_Click()
	RunFunc(0)
End Sub
'***************************************************************
'btn2 event handlers.
'***************************************************************
Sub btn2_Click()
	RunFunc(1)
End Sub
'***************************************************************
'btn3 event handlers.
'***************************************************************
Sub btn3_Click()
	RunFunc(2)
End Sub
'***************************************************************
'btn4 event handlers.
'***************************************************************
Sub btn4_Click()
	RunFunc(3)
End Sub
'***************************************************************
'btnAll event handlers.
'***************************************************************
Sub btnAll_Click()
	RunFunc(-1)
End Sub

Sub CheckColorModel()
	Set img = Objects.ActiveImage
	If docs.IsPointerNull(img) Then  Exit Sub
	ColorSystem = img.GetColorSystem
	img = nil
	btn1.Visible = True
	btn2.Visible = True
	btn3.Visible = True
	btn4.Visible = False
	Select Case  ColorSystem
		case "RGB"
			btn1.ButtonText = "R"
			btn2.ButtonText = "G"
			btn3.ButtonText = "B"
			btn4.ButtonText = sBrightCaption
			btn4.Visible = True
			btnAll.ButtonText = "RGB"
		case "HSB"
			btn1.ButtonText = "H"
			btn2.ButtonText = "S"
			btn3.ButtonText = "B"
			btnAll.ButtonText = "HSB"
		case "YUV"
			btn1.ButtonText = "Y"
			btn2.ButtonText = "U"
			btn3.ButtonText = "V"
			btnAll.ButtonText = "YUV"
		case "GRAY"
			btn1.Visible = False
			btn2.Visible = False
			btn3.Visible = False
			btnAll.ButtonText = "GRAY"
	End Select
	RunFunc(-1)
End Sub

'***************************************************************
'Hist event handlers.
'***************************************************************
Sub Hist_OnNewCalc()
	CheckColorModel()
End Sub


'***************************************************************
'btnZoomUp event handlers.
'***************************************************************
Sub btnZoomUp_Click()
	Hist.ZoomIn(ZoomStep)
End Sub
'***************************************************************
'btnZoomDown event handlers.
'***************************************************************
Sub btnZoomDown_Click()
	Hist.ZoomOut(ZoomStep)
End Sub
