[AxForm]
Version=1
Size=702, 144
Title=%Optical Density Settings%

[AXControls]
Name=fldBackgr0
ProgID=VTCONTROLS.VTStaticText.1
Rect=18, 49, 96, 63
Style=50000000h
ID=3405
Data=254 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 0b 00 00 00 08 00 00 80 0f 00 00 80 0f 00 00 80 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 d4 ee ed 3a 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 10 00 ff ff ff ff ff ff ff ff 42 4d 36 00 00 00 00 00 00 00 36 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 10 00 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 4c d8 d2 81 0c a0 d2 81 01 00 00 00 01 00 00 00 0f 00 00 80 00 00 00 00 00 00 00 00 01 00 00 00

Name=txtMethod
ProgID=VTCONTROLS.VTStaticText.1
Rect=57, 6, 247, 35
Style=50000000h
ID=123
Data=322 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 0b 00 00 00 08 00 00 80 0f 00 00 80 0f 00 00 80 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 48 57 69 74 68 20 62 61 63 6b 67 72 6f 75 6e 64 2c 20 64 61 72 6b 20 66 69 65 6c 64 20 63 6f 72 72 65 63 74 69 6f 6e 20 0d 0a 61 6e 64 20 6f 70 74 69 63 61 6c 20 64 65 6e 73 69 74 79 20 63 61 6c 69 62 72 61 74 69 6f 6e 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 10 00 ff ff ff ff ff ff ff ff 42 4d 36 00 00 00 00 00 00 00 36 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 10 00 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c4 a6 d3 81 0c a0 d2 81 01 00 00 00 01 00 00 00 0f 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00

Name=fldDark0
ProgID=VTCONTROLS.VTStaticText.1
Rect=18, 89, 100, 103
Style=50000000h
ID=3406
Data=264 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 0b 00 00 00 08 00 00 80 0f 00 00 80 0f 00 00 80 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0e d2 e5 ec ed ee e2 ee e5 20 ef ee eb e5 3a 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 10 00 ff ff ff ff ff ff ff ff 42 4d 36 00 00 00 00 00 00 00 36 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 10 00 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 4c d8 d2 81 0c a0 d2 81 01 00 00 00 01 00 00 00 0f 00 00 80 00 00 00 00 00 00 00 00 01 00 00 00

Name=fldBackgr
ProgID=VTCONTROLS.VTStaticText.1
Rect=18, 66, 95, 81
Style=50000000h
ID=3405
Data=253 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 0b 00 00 00 08 00 00 80 0f 00 00 80 0f 00 00 80 01 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 2d 2d 2d 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 10 00 ff ff ff ff ff ff ff ff 42 4d 36 00 00 00 00 00 00 00 36 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 10 00 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f4 63 d3 81 0c a0 d2 81 01 00 00 00 01 00 00 00 0f 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00

Name=fldDark
ProgID=VTCONTROLS.VTStaticText.1
Rect=18, 106, 95, 121
Style=50000000h
ID=3406
Data=253 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 0b 00 00 00 08 00 00 80 0f 00 00 80 0f 00 00 80 01 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 2d 2d 2d 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 10 00 ff ff ff ff ff ff ff ff 42 4d 36 00 00 00 00 00 00 00 36 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 10 00 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f4 63 d3 81 0c a0 d2 81 01 00 00 00 01 00 00 00 0f 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00

Name=txtSpecify
ProgID=VTCONTROLS.VTStaticText.1
Rect=280, 4, 510, 18
Style=50000000h
ID=123
Data=324 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 0b 00 00 00 08 00 00 80 0f 00 00 80 0f 00 00 80 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 dd f2 e0 eb ee ed fb 3a 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 11 00 ff ff ff ff ff ff ff ff 42 4d 36 00 00 00 00 00 00 00 36 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 10 00 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 42 4d 3e 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 01 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff 00 00 00 00 00 01 00 00 00 01 00 00 00 0f 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00

Name=btnSetBackgr
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=104, 61, 246, 83
Style=50000000h
ID=3407
Data=155 0c 01 00 01 00 00 00 00 00 00 00 01 00 01 00 01 00 00 00 00 0e 49 6d 61 67 65 20 49 6e 70 75 74 2e 2e 2e 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 16 00 00 00 44 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 05 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 01 00

Name=btnSetDarkF
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=104, 101, 246, 123
Style=50000000h
ID=3407
Data=164 0c 01 00 01 00 00 00 00 00 00 00 01 00 01 00 01 00 00 00 00 17 cf ee eb f3 f7 e8 f2 fc 20 e8 e7 ee e1 f0 e0 e6 e5 ed e8 e5 2e 2e 2e 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 16 00 00 00 44 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 05 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 01 00

Name=txtSettings
ProgID=VTCONTROLS.VTStaticText.1
Rect=8, 6, 55, 24
Style=50000000h
ID=0
Data=323 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 0b 00 00 00 08 00 00 80 0f 00 00 80 0f 00 00 80 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 07 4d 65 74 68 6f 64 3a 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 11 00 ff ff ff ff ff ff ff ff 42 4d 36 00 00 00 00 00 00 00 36 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 10 00 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 34 12 cf 81 0c 90 ce 81 42 4d 3e 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 01 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff 00 60 00 00 00 01 00 00 00 01 00 00 00 0f 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00

Name=btnDel
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=556, 75, 684, 97
Style=50010000h
ID=3304
Data=148 0a 01 00 01 00 00 00 00 00 00 00 01 00 01 00 01 00 00 00 00 0e d3 e4 e0 eb e8 f2 fc 20 fd f2 e0 eb ee ed 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 16 00 00 00 6d 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 05 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00

Name=txtSamples0
ProgID=VTCONTROLS.VTStaticText.1
Rect=589, 28, 653, 42
Style=50000000h
ID=3403
Data=261 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 0b 00 00 00 08 00 00 80 0f 00 00 80 0f 00 00 80 00 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0b ca ee eb e8 f7 e5 f1 f2 e2 ee 3a 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 10 00 ff ff ff ff ff ff ff ff 42 4d 36 00 00 00 00 00 00 00 36 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 10 00 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 4c d8 d2 81 0c a0 d2 81 01 00 00 00 01 00 00 00 0f 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00

Name=txtSamples
ProgID=VTCONTROLS.VTStaticText.1
Rect=662, 28, 684, 42
Style=50000000h
ID=3403
Data=251 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 0b 00 00 00 08 00 00 80 0f 00 00 80 0f 00 00 80 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 30 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 10 00 ff ff ff ff ff ff ff ff 42 4d 36 00 00 00 00 00 00 00 36 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 10 00 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f4 63 d3 81 0c a0 d2 81 01 00 00 00 01 00 00 00 0f 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00

Name=txtSettingsBorder
ProgID=VTDESIGN.VTD3DBarCtrl.1
Rect=9, 44, 255, 134
Style=58000000h
ID=123
Data=73 00 00 00 00 03 00 00 00 03 00 02 00 00 00 05 00 00 80 01 00 00 00 08 00 00 80 00 64 00 00 00 00 00 01 00 01 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61

Name=btnSetNew
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=556, 48, 684, 70
Style=50010000h
ID=3302
Data=156 0c 01 00 01 00 00 00 00 00 00 00 01 00 01 00 01 00 00 00 00 0f c2 e2 e5 f1 f2 e8 20 ed ee e2 fb e9 2e 2e 2e 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 16 00 00 00 80 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 05 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 01 00

Name=btnOK2
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=275, 5, 352, 26
Style=50010000h
ID=3302
Data=150 0c 01 00 01 00 00 00 00 00 00 00 01 00 01 00 01 00 00 00 00 02 4f 4b 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 15 00 00 00 4d 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 0d 4d 53 20 53 61 6e 73 20 53 65 72 69 66 00 00 00 00 00 00 00 00 00 05 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00

Name=btnCancel2
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=275, 31, 352, 52
Style=50010000h
ID=3302
Data=154 0c 01 00 01 00 00 00 00 00 00 00 01 00 01 00 01 00 00 00 00 06 43 61 6e 63 65 6c 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 15 00 00 00 4d 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 0d 4d 53 20 53 61 6e 73 20 53 65 72 69 66 00 00 00 00 00 00 00 00 00 05 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00

Name=btnHelp2
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=275, 57, 352, 78
Style=50010000h
ID=3302
Data=152 0c 01 00 01 00 00 00 00 00 00 00 01 00 01 00 01 00 00 00 00 04 48 65 6c 70 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 15 00 00 00 4d 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 0d 4d 53 20 53 61 6e 73 20 53 65 72 69 66 00 00 00 00 00 00 00 00 00 05 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00

Name=fldRange
ProgID=VTCONTROLS.VTEditor.1
Rect=637, 1, 683, 19
Style=50000000h
ID=3311
Data=234 00 00 01 00 09 00 00 00 f5 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 00 00 00 00 00 54 61 68 6f 6d 61 00 00 00 00 3d c7 00 78 d8 0f 00 00 ff ff ff ff b1 12 00 78 f0 db 9d 00 60 f1 f5 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 00 00 00 00 00 54 61 68 6f 6d 61 00 e6 82 00 bc e6 82 00 00 00 00 00 00 00 00 00 34 ab 72 81 0c 00 60 00 60 f1 08 56 54 45 64 69 74 6f 72 00 00 07 43 61 70 74 69 6f 6e 01 00 00 00 02 00 01 30 64 00 00 00 00 00 00 00 00 00 00 00 c8 42 00 00 00 00 08 00 00 80 05 00 00 80 08 00 00 80 0f 00 00 80 0f 00 00 80 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

Name=btnClearAll
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=556, 101, 684, 123
Style=50010000h
ID=3303
Data=152 0c 01 00 01 00 00 00 00 00 00 00 01 00 01 00 01 00 00 00 00 0b d3 e4 e0 eb e8 f2 fc 20 e2 f1 e5 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 16 00 00 00 70 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 05 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 01 00

Name=btnAddSample
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=523, 1, 635, 19
Style=50010000h
ID=3303
Data=152 0a 01 00 01 00 00 00 00 00 00 00 01 00 01 00 01 00 00 00 00 12 c2 e2 e5 f1 f2 e8 20 ef ee e2 f2 ee f0 ed ee 2e 2e 2e 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 00 01 01 16 00 00 00 70 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 05 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 01 00 00 00 00 00 00 00

Name=lstSamples
ProgID=VTCONTROLS.VTList.1
Rect=276, 20, 551, 131
Style=50000000h
ID=123
Data=1554 00 00 01 00 01 01 00 01 05 56 4c 69 73 74 0a 00 00 00 07 00 00 00 49 4c 01 01 00 00 02 00 04 00 10 00 10 00 ff ff ff ff 05 00 ff ff ff ff ff ff ff ff 42 4d 76 00 00 00 00 00 00 00 76 00 00 00 28 00 00 00 40 00 00 00 10 00 00 00 01 00 04 00 00 00 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 00 00 80 00 00 00 80 80 00 80 00 00 00 80 00 80 00 80 80 00 00 c0 c0 c0 00 80 80 80 00 00 00 ff 00 00 ff 00 00 00 ff ff 00 ff 00 00 00 ff 00 ff 00 ff ff 00 00 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 42 4d 3e 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 40 00 00 00 10 00 00 00 01 00 01 00 00 00 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 04 00 00 00 04 00 ff ff 01 00 0b 00 43 42 61 73 65 43 6f 6c 75 6d 6e 00 00 05 00 00 00 f5 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 cc 03 02 01 22 54 61 68 6f 6d 61 00 00 ff ff ff ff 60 dc 82 00 b0 4a c0 bf 61 dc 82 00 01 00 00 00 00 02 00 00 01 00 00 00 00 00 00 00 07 c2 e2 e5 e4 e5 ed ee 02 00 00 00 50 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 ff ff ff 00 01 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff ff ff ff ff ff ff ff ff 01 80 00 00 05 00 00 00 f5 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 cc 03 02 01 22 54 61 68 6f 6d 61 00 00 ff ff ff ff 60 dc 82 00 b0 4a c0 bf 61 dc 82 00 01 00 00 00 00 02 00 00 01 00 00 00 00 00 00 00 0a d0 e0 f1 f1 f7 e8 f2 e0 ed ee 02 00 00 00 5a 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 ff ff ff 00 01 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff ff ff ff ff ff ff ff ff 01 80 00 00 05 00 00 00 f5 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 cc 03 02 01 22 54 61 68 6f 6d 61 00 00 ff ff ff ff 60 dc 82 00 b0 4a c0 bf 61 dc 82 00 01 00 00 00 00 02 00 00 01 00 00 00 00 00 00 00 0a ce f2 ea eb ee ed e5 ed e8 e5 02 00 00 00 53 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 ff ff ff 00 01 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff ff ff ff ff ff ff ff ff 01 80 00 00 05 00 00 00 f5 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 cc 03 02 01 22 54 61 68 6f 6d 61 00 00 ff ff ff ff 60 dc 82 00 b0 4a c0 bf 61 dc 82 00 01 00 00 00 00 02 00 00 01 00 00 00 00 00 00 00 09 cd e5 f1 f2 e0 e1 2e 20 25 02 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 ff ff ff 00 01 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff ff ff ff ff ff ff ff ff 0e 00 00 80 0d 00 00 80 ff ff ff 00 0d 00 00 80 0e 00 00 80 01 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 05 56 4c 69 73 74 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

Name=frm2
ProgID=VTDESIGN.VTD3DBarCtrl.1
Rect=279, 19, 692, 134
Style=58000000h
ID=123
Data=73 00 00 00 00 03 00 00 00 03 00 02 00 00 00 05 00 00 80 01 00 00 00 08 00 00 80 00 64 00 00 00 00 00 01 00 01 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61


[Script]
Dim intMethod, intMethodLast, blnNewMethod , txtBack, txtDark
Dim sBackDark, sQuestion, sInputBack, sInfo, sInputImage
Dim sInputDark, sMsgYouhavent, sAcquired, sSure, sNoCorrectValue
Dim sMethod0, sMethod1, sMethod2, sMethod3

intMethodLast = 254
txtBack = "_Background"
txtDark = "_Dark_Field"
blnNewMethod = False

Dim smcount, sEnterSample, sIncorrect, sDecimal, sWarn
Set smcount = CreateObject("Scripting.Dictionary")
btnAddSample.Disabled = True

sngEndRange = 2
txtPath = "\ODensity\SamplesData"

Dim gl_Script

'***************************************************************
'Form event handlers.
'***************************************************************
Sub Form_OnInitialize()
	Set gl_Script = Application.GetGlobalScript("")

	sInfo = Docs.LoadString ("Information")
	sBackDark = Docs.LoadString ("Background and dark field images were found in the active document.\nDo you want to use them instead of loading new images?")
	sQuestion = Docs.LoadString ("Question")
	sInputBack = Docs.LoadString ("Input background image")
	sInputDark = Docs.LoadString ("Input dark field image")
	sInputImage = Docs.LoadString ("First input image!")
	txtSamples0.Text = Docs.LoadString ("Count:")
	btnSetBackgr.ButtonText = Docs.LoadString ("Image Input...")
	btnSetDarkF.ButtonText = Docs.LoadString ("Image Input...")
	txtSettings.Text = Docs.LoadString ("Method:")
	fldBackgr0.Text = Docs.LoadString ("Background:")
	fldDark0.Text = Docs.LoadString ("Dark field:")
	fldBackgr0.Text = Docs.LoadString ("Background:")
	sMsgYouhavent = Docs.LoadString ("You haven`t selected any method.")
	sAcquired = Docs.LoadString ("OD Ok")
	sSure = Docs.LoadString ("Are you sure?")
	sNoCorrectValue = Docs.LoadString ("This sample is already input!")
	sMethod0 = Docs.LoadString ("Method is not selected")
	sMethod2 = Docs.LoadString ("With background and\ndark field correction")
	sMethod3 = Docs.LoadString ("With background, dark field correction \nand optical density calibration")
	sMsgInfo = Docs.LoadString ("Information")

	txtSpecify.Text = Docs.LoadString ("Specify sample image:")
	lstSamples.SetColumnCaption 0, Docs.LoadString ("Given OD")
	lstSamples.SetColumnCaption 1, Docs.LoadString ("Calculated OD")
	lstSamples.SetColumnCaption 2, Docs.LoadString ("Deviation, %")
	lstSamples.SetColumnCaption 3, Docs.LoadString ("Instability %")
	btnSetNew.ButtonText = Docs.LoadString ("Acquire New Sample...")
	btnAddSample.ButtonText = Docs.LoadString ("Acquire Repeatedly...")
	btnDel.ButtonText = Docs.LoadString ("Delete Sample Image")
	btnClearAll.ButtonText = Docs.LoadString ("Delete All")
	sEnterSample = Docs.LoadString ("Enter sample optical density")
	sIncorrect = Docs.LoadString ("Numeric value is entered incorrectly!")
	sDecimal = Docs.LoadString ("Perhaps, decimal point is wrong.")
	sWarn = Docs.LoadString ("Warning")
	
	btnOk2.ButtonText = Docs.LoadString ("OK")	
	btnCancel2.ButtonText = Docs.LoadString ("ButtonCancel")
	btnHelp2.ButtonText = Docs.LoadString ("Help")
	'-------------------------------
	fldRange.Visible = False
	btnAddSample.Visible = False
	'-------------------------------

	intMethodLast = Data.GetValue ("\ODensity\Method")
	If OpticMeasure.Method = 0 Then 
		'Методика еще не запускалась //
		Call clear_all
	End If

	Call RefreshForm

	If intMethodLast <> 2 Then Exit Sub

	intSamplesCount = Data.GetValue("\ODensity\SampleImages")

	Data.SetSection txtPath
	i = 0
	Do
		sngGiven = 0
		sngGiven = CDbl(Data.GetValue(txtPath & "\GivenSample" & i))
		dblCalc  = CDbl(Data.GetValue(txtPath & "\CalcSample" & i))
		intNum   = CDbl(Data.GetValue(txtPath & "\NumSample" & i))
		If sngGiven = 0 Then Exit Do
		btnAddSample.Disabled = False
		smcount.Item(CStr(sngGiven)) = intNum
		lstSamples.AddRow(-1)
		lstSamples.SetCellValue 0, i, sngGiven
		lstSamples.SetCellValue 1, i, gl_Script.FormatNumberEx(dblCalc, 2, 2)
		lstSamples.SetCellValue 3, i, dblCalc & "=" & intNum	'lstSamples.SetCellValue 4
		Call CalcDeviation(i)
		i = i + 1
	Loop Until sngGiven = 0
	fldRange.Text = sngEndRange
	Call DrawGraph

	Call RefreshForm

End Sub

sub Form_OnOK()
	Data.SetValue "\ODensity\SettingsOk", 1
	
	If intMethodLast <> 2 Then Exit Sub

	Call save_lstSamples
end sub

sub Form_OnCancel()
	Data.SetValue "\ODensity\SettingsOk", -1

	If intMethodLast <> 2 Then Exit Sub

	Call save_lstSamples
end sub

Sub Form_OnDestroy
	Set smcount = Nothing
	Set imgExample = Nothing
	Set objActDoc = Nothing
	Set objImageDoc = Nothing

	Set gl_Script = Nothing
End Sub


'***************************************************************
'Misc
'***************************************************************
Sub RefreshForm
'	On Error Resume Next
	intMethod = Data.GetDefValue("\ODensity\Method", 1)
	If intMethod < 1 Or intMethod > 2 Then
		intMethod = 1
		Data.SetValue "\ODensity\Method", intMethod
	End If

	intBackgr = CInt(Data.Getvalue("\ODensity\Backgr"))
	intDark   = CInt(Data.Getvalue("\ODensity\Dark"))
	intSamples = Data.Getvalue("\ODensity\Samples")

	If intBackgr = 1 Then
		fldBackgr.Text = " " & sAcquired
	Else
		fldBackgr.Text = " ---"
	End If
	
	If intDark = 1 Then
		fldDark.Text = " " & sAcquired
	Else
		fldDark.Text = " ---"
	End If

	If intBackgr = 1 And intDark = 1 Then
		OpticMeasure.Method = intMethod
		FormManager.EnableOk True
		btnOK2.Disabled False
		btnSetNew.Disabled False
		btnDel.Disabled CBool(lstSamples.GetRowCount < 1)
	Else
		FormManager.EnableOk False
		btnOK2.Disabled True
		btnSetNew.Disabled True
		btnDel.Disabled True
	End If

	Select Case intMethod
		Case 1
			txtMethod.Text = sMethod2
			fldBackgr0.Disabled = False
			fldBackgr.Disabled = False
			btnSetBackgr.Disabled = False
			fldDark0.Disabled = False
			fldDark.Disabled = False
			txtSamples0.Visible = False
			txtSamples.Visible = False
			txtSamples.Text = "---"
			txtSpecify.Visible = False
			lstSamples.Visible = False
			btnSetNew.Visible = False
			btnAddSample.Visible = False
			btnDel.Visible = False
			btnClearAll.Visible = False
			frm2.Visible = False
			btnOK2.Visible = True
			btnCancel2.Visible = True
			btnHelp2.Visible = True
			Form.ShowButtons 0
		Case 2
			txtMethod.Text = sMethod3
			fldBackgr0.Disabled = False
			fldBackgr.Disabled = False
			btnSetBackgr.Disabled = False
			fldDark0.Disabled = False
			fldDark.Disabled = False
			txtSamples0.Visible = False	'True
			txtSamples.Visible = False	'True
			txtSamples.Text = intSamples
			'MsgBox "intSamples=" & intSamples
			txtSpecify.Visible = True
			lstSamples.Visible = True
			btnSetNew.Visible = True
			'btnAddSample.Visible = True
			btnDel.Visible = True
			btnClearAll.Visible = True
			frm2.Visible = True
			btnOK2.Visible = False
			btnCancel2.Visible = False
			btnHelp2.Visible = False
			Form.ShowButtons 15
	End Select
End Sub

'***************************************************************
'btnSetBackgr event handlers.
'***************************************************************
Sub btnSetBackgr_Click()
	intErr = ActionManager.InputImageInCurrentDoc (0,1,1,txtBack)
	If intErr = 0 Then intMethod = Data.Getvalue("\ODensity\Method"): Exit Sub
	
	Median 20, txtBack, txtBack

	Set imgBackgr = Objects.GetObjectByName(txtBack)
	OpticMeasure.SetBackground imgBackgr
	Set imgBackgr = Nothing

	Data.Setvalue "\ODensity\Backgr", 1
	Call RefreshForm
End Sub

'***************************************************************
'btnSetDarkF event handlers.
'***************************************************************
sub btnSetDarkF_Click()
	intErr = ActionManager.InputImageInCurrentDoc (0,1,1,txtDark)
	If intErr = 0 Then Exit Sub

	Set imgDark = Objects.GetObjectByName(txtDark)
	OpticMeasure.SetDarkField imgDark
	Set imgDark = Nothing

	Data.Setvalue "\ODensity\Dark",   1
	Call RefreshForm
end sub




'***************************************************************
'btnOK2 event handlers.
'***************************************************************
sub btnOK2_Click()
	FormManager.PressOk
end sub
'***************************************************************
'btnCancel2 event handlers.
'***************************************************************
sub btnCancel2_Click()
	FormManager.PressCancel
end sub
'***************************************************************
'btnHelp2 event handlers.
'***************************************************************
sub btnHelp2_Click()
	FormManager.PressHelp
end sub



'***************************************************************
'btnSetNew event handlers.
'***************************************************************
Sub btnSetNew_Click()
	Do
		txtOD = InputBox (sEnterSample, gl_Script.sVT)
		If txtOD = "" Then Exit Sub
		dblODent = Application.VtDbl(txtOD)
		If dblODent > 0 Then Exit Do
		MsgBox sIncorrect & vbNewLine & _
			sDecimal, vbInformation, gl_Script.sVT
	Loop
	If smcount.Exists(CStr(dblODent)) Then
		'smcount.Item(CStr(dblODent)) = smcount.Item(CStr(dblODent)) + 1
		MsgBox sNoCorrectValue, vbInformation, gl_Script.sVT
		Exit Sub
	Else
		smcount.Add CStr(dblODent), 1
	End If
	txtImgName = "_Sample(" & CStr(dblODent) & ")"
	If smcount.Item(CStr(dblODent)) > 1 Then txtImgName = txtImgName & "-" & smcount.Item(CStr(dblODent))
	
	If Not isDocImage Then ActionManager.FileNew("Image")
	If isObjectExists(txtImgName) Then
		Set imgExample = Objects.GetObjectByName(txtImgName)
		Objects.RemoveObject imgExample
	End If
	intErr = ActionManager.InputImageInCurrentDoc (0,1,1,txtImgName)
	If intErr = 1 Then
		'Call ReduceSize(txtImgName)
		Resize 400, 300, txtImgName, txtImgName
		Set imgExample = Objects.GetObjectByName(txtImgName)
		dblODcalc = OpticMeasure.AddExample(dblODent,imgExample)
		
		lstSamples.AddRow(-1)
		intCurrentRow = lstSamples.GetRowCount - 1
		lstSamples.SetCurentRow intCurrentRow
		lstSamples.SetCellValue 0,intCurrentRow, dblODent
		lstSamples.SetCellValue 1,intCurrentRow, gl_Script.FormatNumberEx(dblODcalc, 2, 2)
		lstSamples.SetCellValue 3,intCurrentRow, dblODcalc & "=" & smcount.Item(CStr(dblODent))	'lstSamples.SetCellValue 4
		
		Call CalcDeviation(intCurrentRow)
		Call DrawGraph
		btnAddSample.Disabled = False
	Else
		smcount.Item(CStr(dblODent)) = smcount.Item(CStr(dblODent)) - 1
		If smcount.Item(CStr(dblODent)) = 0 Then smcount.Remove(CStr(dblODent))
	End If

	txtSamples.Text = lstSamples.GetRowCount

	Call RefreshForm
End Sub

'***************************************************************
'btnAddSample event handlers.
'***************************************************************
Sub btnAddSample_Click()
	intCurrentRow = lstSamples.GetCurentRow
	dblODent = CDbl(lstSamples.GetCellAsValue(0, intCurrentRow))
	smcount.Item(CStr(dblODent)) = smcount.Item(CStr(dblODent)) + 1
	txtImgName = "_Sample(" & CStr(dblODent) & ")-" & CStr(smcount.Item(CStr(dblODent)))
	If Not isDocImage Then ActionManager.FileNew("Image")
	If isObjectExists(txtImgName) Then
		Set imgExample = Objects.GetObjectByName(txtImgName)
		Objects.RemoveObject imgExample
	End If
	intErr = ActionManager.InputImageInCurrentDoc (0,1,1,txtImgName)
	If intErr = 1 Then
		Resize 200, 200, txtImgName, txtImgName
		Set imgExample = Objects.GetObjectByName(txtImgName)
		dblODcalc = OpticMeasure.AddExample(dblODent,imgExample)
		lstSamples.AddRow(intCurrentRow + 1)
		intCurrentRow = intCurrentRow + 1
		lstSamples.SetCurentRow intCurrentRow
		lstSamples.SetCellValue 0,intCurrentRow, dblODent
		lstSamples.SetCellValue 1,intCurrentRow, gl_Script.FormatNumberEx(dblODcalc, 2, 2)
		lstSamples.SetCellValue 3,intCurrentRow, dblODcalc & "=" & smcount.Item(CStr(dblODent))	'lstSamples.SetCellValue 4
		Call CalcDeviation(intCurrentRow)
		Call DrawGraph
	Else
		smcount.Item(CStr(dblODent)) = smcount.Item(CStr(dblODent)) - 1
	End If

	txtSamples.Text = lstSamples.GetRowCount

	Call RefreshForm
End Sub

'***************************************************************
'btnDel event handlers.
'***************************************************************
Sub btnDel_Click()
	If MsgBox (sSure, vbYesNo + vbQuestion, gl_Script.sVT) <> vbYes Then Exit Sub

	enableCancel = False
	intCurrentRow = lstSamples.GetCurentRow
	dblODent     = CDbl(lstSamples.GetCellAsValue(0,intCurrentRow))
	arr = Split( lstSamples.GetCellAsValue(3,intCurrentRow), "=" )	'lstSamples.GetCellAsValue(3...
	If UBound(arr) > 0 Then
		dblODcalc = CDbl(arr(0))
		intSampleNum = CInt("0" & arr(1))
	Else
		dblODcalc = CDbl(0)
		intSampleNum = CInt(0)
	End If
	txtImgName = "_Sample(" & CStr(dblODent) & ")"
	If intSampleNum > 1 Then txtImgName = txtImgName & "-" & CStr(intSampleNum)
	If isObjectExists(txtImgName) Then
		Set imgExample = Objects.GetObjectByName(txtImgName)
		Objects.RemoveObject imgExample
	End If
	blnDelSuccsess = OpticMeasure.RemoveSampleCalc(dblODent, dblODcalc)
	lstSamples.DeleteRow intCurrentRow
	intMax = 0
	For i = 0 To lstSamples.GetRowCount - 1
		If lstSamples.GetCellAsValue(0,i) = dblODent Then
			intNum = lstSamples.GetCellAsValue(3,i)		'lstSamples.GetCellAsValue(3...
			If intNum > intMax Then intMax = intNum
		End If
	Next
	If intMax = 0 Then
		smcount.Remove(CStr(dblODent))
	Else
		smcount.Item(CStr(dblODent)) = intMax
	End If
	Call DrawGraph

	txtSamples.Text = lstSamples.GetRowCount

	Call RefreshForm
End Sub

'***************************************************************
'
'***************************************************************
Sub CalcDeviation(intRow)
	dblODent = CDbl(lstSamples.GetCellAsValue(0,intRow))
	dblODentCalc = CDbl(lstSamples.GetCellAsValue(1,intRow))
	sngDev = ( dblODent - dblODentCalc ) / dblODent * 100
	lstSamples.SetCellValue 2, intRow, FormatNumber(sngDev, 2)

	Exit Sub

	'расчет нестабильности изображений для одного эталона //
	sngAvr = 0
	j = 0
	For i = 0 To lstSamples.GetRowCount - 1
		If dblODent = CDbl(lstSamples.GetCellAsValue(0,i)) Then 
			sngAvr = sngAvr + CDbl(lstSamples.GetCellAsValue(1,i))
			j = j + 1
		End If
	Next
	If j > 0 Then 
		sngAvr = sngAvr / j
	Else
		sngAvr = dblODentCalc
	End If
	For i = 0 To lstSamples.GetRowCount - 1
		If dblODent = CDbl(lstSamples.GetCellAsValue(0,i)) Then 
			sngInst = (CDbl(lstSamples.GetCellAsValue(1,i)) - sngAvr) / sngAvr * 100
			lstSamples.SetCellValue 3, i, CCur(sngInst)
		End If
	Next
End Sub

'***************************************************************
'
'***************************************************************
Sub DrawGraph
	Call CreateTextGraph
End Sub

Sub CreateTextGraph
	Const ForWriting = 2
	Dim fso, f, sFileName, sFileBody
	Dim sngVal

	For i = 0 To 1000
		sngVal = i * sngEndRange / 1000
		sFileBody = sFileBody & CStr2(sngVal) & vbTab
		sFileBody = sFileBody & CStr2(OpticMeasure.Interpolate(sngVal)) & vbNewLine
	Next

	sFileBody = sFileBody & vbNewLine
	For i = 0 To lstSamples.GetRowCount - 1
		sFileBody = sFileBody & CStr2(lstSamples.GetCellAsValue(1,i)) & vbTab
		sFileBody = sFileBody & CStr2(lstSamples.GetCellAsValue(0,i)) & vbNewLine
	Next

	sFileName = Data.GetValue ("\Paths\CurrentPath") & "ODGraph.txt"
	Set fso = CreateObject("Scripting.FileSystemObject")
	Set f = fso.OpenTextFile(sFileName, ForWriting, True)
	f.Write sFileBody
	f.Close
End Sub

Function CStr2(str)
	CStr2 = Replace(str, ",", ".")
End Function

Function isDocImage
	Set objActDoc = Docs.ActiveDocument
	Set objImageDoc = Docs.GetActiveDocument("Image")
	isDocImage = (TypeName(objActDoc) = "Object" And objActDoc Is objImageDoc)
End Function

Function isObjectExists(txtSeekName)
	isObjectExists = False
	lngPos = Objects.GetFirstObjectPos("Image")
	Do Until lngPos = 0
		Set objImg = Objects.GetObject("Image",lngPos)
		If objImg.Name = txtSeekName Then isObjectExists = True: Exit Do
		lngPos = Objects.GetNextObjectPos("Image",lngPos)
	Loop
End Function



Sub save_lstSamples
	Data.RemoveValue "\ODensity\SamplesData"

	intSamplesCount = lstSamples.GetRowCount
	Data.SetValue "\ODensity\Samples", smcount.Count
	Data.SetValue "\ODensity\SampleImages", intSamplesCount
	For i = 0 To intSamplesCount - 1
		Data.SetValue txtPath & "\GivenSample" & i , lstSamples.GetCellAsValue(0,i)
		Data.SetValue txtPath & "\CalcSample" & i , lstSamples.GetCellAsValue(1,i)

		arr = Split( lstSamples.GetCellAsValue(3,i), "=" )		'lstSamples.GetCellAsValue(3...
		If UBound(arr) > 0 Then
			Data.SetValue txtPath & "\NumSample" & i , arr(1)
		Else
			Data.SetValue txtPath & "\NumSample" & i , 0
		End If
	Next
End Sub


'***************************************************************
'fldRange event handlers.
'***************************************************************
Sub fldRange_DataChange()
	sngVal = CSng(fldRange.Text)
	If sngVal =< 0 Then Exit Sub
	sngEndRange = sngVal
	Call DrawGraph
End Sub


Sub ReduceSize(txtImgName)
	Set objImg = Objects.GetObjectByName(txtImgName)
	dWidth = CDbl(objImg.GetWidth)
	dHeight = CDbl(objImg.GetHeight)
	Resize 200, 200, txtImgName, txtImgName
End Sub
'***************************************************************
'btnClearAll event handlers.
'***************************************************************
sub btnClearAll_Click()
	If MsgBox (sSure, vbYesNo + vbQuestion, gl_Script.sVT) <> vbYes Then Exit Sub
	Call clear_all
	Call RefreshForm
end sub

Sub clear_all
	Dim i
	OpticMeasure.Free
	Data.Setvalue "\ODensity\Backgr", 0
	Data.Setvalue "\ODensity\Dark", 0
	Data.Setvalue "\ODensity\Samples", 0
	Data.Setvalue "\ODensity\SampleImages", 0
	Data.RemoveValue "\ODensity\SamplesData\"
	For i = 0 To lstSamples.GetRowCount - 1
		lstSamples.DeleteRow 0
	Next
	smcount.RemoveAll
End Sub