[AxForm]
Version=1
Size=304, 267
Title=%Calibration%

[AXControls]
Name=CalibrList
ProgID=VTCONTROLS.VTList.1
Rect=10, 30, 148, 159
Style=50000000h
ID=4201
Data=1124 00 00 01 00 01 01 00 01 05 56 4c 69 73 74 0a 00 00 00 07 00 00 00 49 4c 01 01 00 00 02 00 04 00 10 00 10 00 ff ff ff ff 05 00 ff ff ff ff ff ff ff ff 42 4d 76 00 00 00 00 00 00 00 76 00 00 00 28 00 00 00 40 00 00 00 10 00 00 00 01 00 04 00 00 00 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 00 00 80 00 00 00 80 80 00 80 00 00 00 80 00 80 00 80 80 00 00 c0 c0 c0 00 80 80 80 00 00 00 ff 00 00 ff 00 00 00 ff ff 00 ff 00 00 00 ff 00 ff 00 ff ff 00 00 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 42 4d 3e 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 40 00 00 00 10 00 00 00 01 00 01 00 00 00 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 01 00 00 00 01 00 ff ff 01 00 0b 00 43 42 61 73 65 43 6f 6c 75 6d 6e 00 00 05 00 00 00 f5 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 cc 03 02 01 22 54 61 68 6f 6d 61 00 00 ff ff ff ff 60 dc 82 00 b0 4a c0 bf 61 dc 82 00 01 00 00 00 00 02 00 00 00 00 00 00 00 00 00 00 05 56 61 6c 75 65 02 00 00 00 78 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 ff ff ff 00 01 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff ff ff ff ff ff ff ff ff 12 00 00 80 ff ff ff 00 ff ff ff 00 0d 00 00 80 0e 00 00 80 01 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 05 56 4c 69 73 74 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

Name=AddUnit
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=159, 161, 244, 183
Style=50000000h
ID=4204
Data=142 0a 01 00 01 00 00 00 00 00 00 00 01 00 01 00 01 00 00 00 00 08 4e 65 77 20 55 6e 69 74 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 22 01 01 16 00 00 00 55 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 00 5e 22 00 e0 5d 22 00 7c 5d 22 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00

Name=DelUnit
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=244, 161, 292, 183
Style=50000000h
ID=4205
Data=140 0a 01 00 01 00 00 00 00 00 00 00 01 00 01 00 01 00 00 00 00 06 44 65 6c 65 74 65 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 22 01 01 16 00 00 00 30 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 00 5e 22 00 bc 36 22 00 7c 5d 22 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00

Name=btnDelete
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=10, 161, 148, 183
Style=50000000h
ID=4203
Data=152 0a 01 00 01 00 00 00 00 00 00 00 01 00 01 00 01 00 00 00 00 12 44 65 6c 65 74 65 20 43 61 6c 69 62 72 61 74 69 6f 6e 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 72 01 01 16 00 00 00 8a 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 00 00 00 00 00 00 00 00 00 00 00 00 00 0c 00 00 00 09 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00

Name=Control57
ProgID=VTDESIGN.VTD3DBarCtrl.1
Rect=9, 191, 294, 228
Style=58000000h
ID=123
Data=73 00 00 00 00 03 00 00 00 03 00 02 00 00 00 05 00 00 80 01 00 00 00 08 00 00 80 00 64 00 00 00 00 00 01 00 01 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61

Name=txtCoeff
ProgID=VTCONTROLS.VTStaticText.1
Rect=115, 203, 285, 220
Style=50000000h
ID=4210
Data=1269 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 0a 00 00 00 00 00 00 00 c0 c0 c0 00 c0 c0 c0 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 07 30 2e 30 0d 0a 0d 0a 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 08 00 ff ff ff ff ff ff ff ff 42 4d 36 04 00 00 00 00 00 00 36 04 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 08 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 00 00 80 00 00 00 80 80 00 80 00 00 00 80 00 80 00 80 80 00 00 c0 c0 c0 00 c0 dc c0 00 f0 ca a6 00 04 04 04 00 08 08 08 00 0c 0c 0c 00 11 11 11 00 16 16 16 00 1c 1c 1c 00 22 22 22 00 29 29 29 00 55 55 55 00 4d 4d 4d 00 42 42 42 00 39 39 39 00 80 7c ff 00 50 50 ff 00 93 00 d6 00 ff ec cc 00 c6 d6 ef 00 d6 e7 e7 00 90 a9 ad 00 00 00 33 00 00 00 66 00 00 00 99 00 00 00 cc 00 00 33 00 00 00 33 33 00 00 33 66 00 00 33 99 00 00 33 cc 00 00 33 ff 00 00 66 00 00 00 66 33 00 00 66 66 00 00 66 99 00 00 66 cc 00 00 66 ff 00 00 99 00 00 00 99 33 00 00 99 66 00 00 99 99 00 00 99 cc 00 00 99 ff 00 00 cc 00 00 00 cc 33 00 00 cc 66 00 00 cc 99 00 00 cc cc 00 00 cc ff 00 00 ff 66 00 00 ff 99 00 00 ff cc 00 33 00 00 00 33 00 33 00 33 00 66 00 33 00 99 00 33 00 cc 00 33 00 ff 00 33 33 00 00 33 33 33 00 33 33 66 00 33 33 99 00 33 33 cc 00 33 33 ff 00 33 66 00 00 33 66 33 00 33 66 66 00 33 66 99 00 33 66 cc 00 33 66 ff 00 33 99 00 00 33 99 33 00 33 99 66 00 33 99 99 00 33 99 cc 00 33 99 ff 00 33 cc 00 00 33 cc 33 00 33 cc 66 00 33 cc 99 00 33 cc cc 00 33 cc ff 00 33 ff 33 00 33 ff 66 00 33 ff 99 00 33 ff cc 00 33 ff ff 00 66 00 00 00 66 00 33 00 66 00 66 00 66 00 99 00 66 00 cc 00 66 00 ff 00 66 33 00 00 66 33 33 00 66 33 66 00 66 33 99 00 66 33 cc 00 66 33 ff 00 66 66 00 00 66 66 33 00 66 66 66 00 66 66 99 00 66 66 cc 00 66 99 00 00 66 99 33 00 66 99 66 00 66 99 99 00 66 99 cc 00 66 99 ff 00 66 cc 00 00 66 cc 33 00 66 cc 99 00 66 cc cc 00 66 cc ff 00 66 ff 00 00 66 ff 33 00 66 ff 99 00 66 ff cc 00 cc 00 ff 00 ff 00 cc 00 99 99 00 00 99 33 99 00 99 00 99 00 99 00 cc 00 99 00 00 00 99 33 33 00 99 00 66 00 99 33 cc 00 99 00 ff 00 99 66 00 00 99 66 33 00 99 33 66 00 99 66 99 00 99 66 cc 00 99 33 ff 00 99 99 33 00 99 99 66 00 99 99 99 00 99 99 cc 00 99 99 ff 00 99 cc 00 00 99 cc 33 00 66 cc 66 00 99 cc 99 00 99 cc cc 00 99 cc ff 00 99 ff 00 00 99 ff 33 00 99 cc 66 00 99 ff 99 00 99 ff cc 00 99 ff ff 00 cc 00 00 00 99 00 33 00 cc 00 66 00 cc 00 99 00 cc 00 cc 00 99 33 00 00 cc 33 33 00 cc 33 66 00 cc 33 99 00 cc 33 cc 00 cc 33 ff 00 cc 66 00 00 cc 66 33 00 99 66 66 00 cc 66 99 00 cc 66 cc 00 99 66 ff 00 cc 99 00 00 cc 99 33 00 cc 99 66 00 cc 99 99 00 cc 99 cc 00 cc 99 ff 00 cc cc 00 00 cc cc 33 00 cc cc 66 00 cc cc 99 00 cc cc cc 00 cc cc ff 00 cc ff 00 00 cc ff 33 00 99 ff 66 00 cc ff 99 00 cc ff cc 00 cc ff ff 00 cc 00 33 00 ff 00 66 00 ff 00 99 00 cc 33 00 00 ff 33 33 00 ff 33 66 00 ff 33 99 00 ff 33 cc 00 ff 33 ff 00 ff 66 00 00 ff 66 33 00 cc 66 66 00 ff 66 99 00 ff 66 cc 00 cc 66 ff 00 ff 99 00 00 ff 99 33 00 ff 99 66 00 ff 99 99 00 ff 99 cc 00 ff 99 ff 00 ff cc 00 00 ff cc 33 00 ff cc 66 00 ff cc 99 00 ff cc cc 00 ff cc ff 00 ff ff 33 00 cc ff 66 00 ff ff 99 00 ff ff cc 00 66 66 ff 00 66 ff 66 00 66 ff ff 00 ff 66 66 00 ff 66 ff 00 ff ff 66 00 21 00 a5 00 5f 5f 5f 00 77 77 77 00 86 86 86 00 96 96 96 00 cb cb cb 00 b2 b2 b2 00 d7 d7 d7 00 dd dd dd 00 e3 e3 e3 00 ea ea ea 00 f1 f1 f1 00 f8 f8 f8 00 f0 fb ff 00 a4 a0 a0 00 80 80 80 00 00 00 ff 00 00 ff 00 00 00 ff ff 00 ff 00 00 00 ff 00 ff 00 ff ff 00 00 ff ff ff 00 ec 16 d0 81 01 00 00 00 01 00 00 00 0f 00 00 80 00 00 00 00

Name=UnitList
ProgID=VTCONTROLS.VTList.1
Rect=159, 30, 292, 159
Style=50000000h
ID=4202
Data=1262 00 00 01 00 01 01 01 01 05 56 4c 69 73 74 0a 00 00 00 07 00 00 00 49 4c 01 01 00 00 02 00 04 00 10 00 10 00 ff ff ff ff 05 00 ff ff ff ff ff ff ff ff 42 4d 76 00 00 00 00 00 00 00 76 00 00 00 28 00 00 00 40 00 00 00 10 00 00 00 01 00 04 00 00 00 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 00 00 80 00 00 00 80 80 00 80 00 00 00 80 00 80 00 80 80 00 00 c0 c0 c0 00 80 80 80 00 00 00 ff 00 00 ff 00 00 00 ff ff 00 ff 00 00 00 ff 00 ff 00 ff ff 00 00 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 42 4d 3e 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 40 00 00 00 10 00 00 00 01 00 01 00 00 00 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 02 00 00 00 02 00 ff ff 01 00 0b 00 43 42 61 73 65 43 6f 6c 75 6d 6e 00 00 05 00 00 00 f5 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 cc 03 02 01 22 54 61 68 6f 6d 61 00 00 ff ff ff ff 60 dc 82 00 b0 4a c0 bf 61 dc 82 00 01 00 00 00 00 02 00 00 01 00 00 00 20 00 00 00 05 56 61 6c 75 65 02 00 00 00 41 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 ff ff ff 00 01 00 00 00 00 00 00 00 04 00 00 00 ff ff ff ff ff ff ff ff ff ff ff ff 01 80 00 00 05 00 00 00 f5 ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 90 01 00 00 00 00 00 cc 03 02 01 22 54 61 68 6f 6d 61 00 00 ff ff ff ff 60 dc 82 00 b0 4a c0 bf 61 dc 82 00 01 00 00 00 00 02 00 00 01 00 00 00 00 00 00 00 05 56 61 6c 75 65 02 00 00 00 32 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 ff ff ff 00 01 00 00 00 00 00 00 00 04 00 00 00 ff ff ff ff ff ff ff ff ff ff ff ff 0e 00 00 80 0d 00 00 80 ff ff ff 00 0d 00 00 80 0e 00 00 80 01 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 05 56 4c 69 73 74 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

Name=txtCoeffTitle
ProgID=VTCONTROLS.VTStaticText.1
Rect=30, 203, 110, 220
Style=50000000h
ID=4210
Data=1272 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 00 00 00 90 01 44 42 01 00 06 54 61 68 6f 6d 61 0a 00 00 00 00 00 00 00 c0 c0 c0 00 c0 c0 c0 00 00 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0a 43 6f 65 66 66 2e 20 3d 0d 0a 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 08 00 ff ff ff ff ff ff ff ff 42 4d 36 04 00 00 00 00 00 00 36 04 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 08 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 00 00 80 00 00 00 80 80 00 80 00 00 00 80 00 80 00 80 80 00 00 c0 c0 c0 00 c0 dc c0 00 f0 ca a6 00 04 04 04 00 08 08 08 00 0c 0c 0c 00 11 11 11 00 16 16 16 00 1c 1c 1c 00 22 22 22 00 29 29 29 00 55 55 55 00 4d 4d 4d 00 42 42 42 00 39 39 39 00 80 7c ff 00 50 50 ff 00 93 00 d6 00 ff ec cc 00 c6 d6 ef 00 d6 e7 e7 00 90 a9 ad 00 00 00 33 00 00 00 66 00 00 00 99 00 00 00 cc 00 00 33 00 00 00 33 33 00 00 33 66 00 00 33 99 00 00 33 cc 00 00 33 ff 00 00 66 00 00 00 66 33 00 00 66 66 00 00 66 99 00 00 66 cc 00 00 66 ff 00 00 99 00 00 00 99 33 00 00 99 66 00 00 99 99 00 00 99 cc 00 00 99 ff 00 00 cc 00 00 00 cc 33 00 00 cc 66 00 00 cc 99 00 00 cc cc 00 00 cc ff 00 00 ff 66 00 00 ff 99 00 00 ff cc 00 33 00 00 00 33 00 33 00 33 00 66 00 33 00 99 00 33 00 cc 00 33 00 ff 00 33 33 00 00 33 33 33 00 33 33 66 00 33 33 99 00 33 33 cc 00 33 33 ff 00 33 66 00 00 33 66 33 00 33 66 66 00 33 66 99 00 33 66 cc 00 33 66 ff 00 33 99 00 00 33 99 33 00 33 99 66 00 33 99 99 00 33 99 cc 00 33 99 ff 00 33 cc 00 00 33 cc 33 00 33 cc 66 00 33 cc 99 00 33 cc cc 00 33 cc ff 00 33 ff 33 00 33 ff 66 00 33 ff 99 00 33 ff cc 00 33 ff ff 00 66 00 00 00 66 00 33 00 66 00 66 00 66 00 99 00 66 00 cc 00 66 00 ff 00 66 33 00 00 66 33 33 00 66 33 66 00 66 33 99 00 66 33 cc 00 66 33 ff 00 66 66 00 00 66 66 33 00 66 66 66 00 66 66 99 00 66 66 cc 00 66 99 00 00 66 99 33 00 66 99 66 00 66 99 99 00 66 99 cc 00 66 99 ff 00 66 cc 00 00 66 cc 33 00 66 cc 99 00 66 cc cc 00 66 cc ff 00 66 ff 00 00 66 ff 33 00 66 ff 99 00 66 ff cc 00 cc 00 ff 00 ff 00 cc 00 99 99 00 00 99 33 99 00 99 00 99 00 99 00 cc 00 99 00 00 00 99 33 33 00 99 00 66 00 99 33 cc 00 99 00 ff 00 99 66 00 00 99 66 33 00 99 33 66 00 99 66 99 00 99 66 cc 00 99 33 ff 00 99 99 33 00 99 99 66 00 99 99 99 00 99 99 cc 00 99 99 ff 00 99 cc 00 00 99 cc 33 00 66 cc 66 00 99 cc 99 00 99 cc cc 00 99 cc ff 00 99 ff 00 00 99 ff 33 00 99 cc 66 00 99 ff 99 00 99 ff cc 00 99 ff ff 00 cc 00 00 00 99 00 33 00 cc 00 66 00 cc 00 99 00 cc 00 cc 00 99 33 00 00 cc 33 33 00 cc 33 66 00 cc 33 99 00 cc 33 cc 00 cc 33 ff 00 cc 66 00 00 cc 66 33 00 99 66 66 00 cc 66 99 00 cc 66 cc 00 99 66 ff 00 cc 99 00 00 cc 99 33 00 cc 99 66 00 cc 99 99 00 cc 99 cc 00 cc 99 ff 00 cc cc 00 00 cc cc 33 00 cc cc 66 00 cc cc 99 00 cc cc cc 00 cc cc ff 00 cc ff 00 00 cc ff 33 00 99 ff 66 00 cc ff 99 00 cc ff cc 00 cc ff ff 00 cc 00 33 00 ff 00 66 00 ff 00 99 00 cc 33 00 00 ff 33 33 00 ff 33 66 00 ff 33 99 00 ff 33 cc 00 ff 33 ff 00 ff 66 00 00 ff 66 33 00 cc 66 66 00 ff 66 99 00 ff 66 cc 00 cc 66 ff 00 ff 99 00 00 ff 99 33 00 ff 99 66 00 ff 99 99 00 ff 99 cc 00 ff 99 ff 00 ff cc 00 00 ff cc 33 00 ff cc 66 00 ff cc 99 00 ff cc cc 00 ff cc ff 00 ff ff 33 00 cc ff 66 00 ff ff 99 00 ff ff cc 00 66 66 ff 00 66 ff 66 00 66 ff ff 00 ff 66 66 00 ff 66 ff 00 ff ff 66 00 21 00 a5 00 5f 5f 5f 00 77 77 77 00 86 86 86 00 96 96 96 00 cb cb cb 00 b2 b2 b2 00 d7 d7 d7 00 dd dd dd 00 e3 e3 e3 00 ea ea ea 00 f1 f1 f1 00 f8 f8 f8 00 f0 fb ff 00 a4 a0 a0 00 80 80 80 00 00 00 ff 00 00 ff 00 00 00 ff ff 00 ff 00 00 00 ff 00 ff 00 ff ff 00 00 ff ff ff 00 ec 16 d0 81 01 00 00 00 01 00 00 00 0f 00 00 80 00 00 00 00

Name=chkPix
ProgID=VTCHECKBOX.VTCheckBoxCtrl.1
Rect=82, 1, 231, 22
Style=50000000h
ID=0
Data=130 00 00 00 00 04 00 00 00 00 00 00 00 14 c8 e7 ec e5 f0 e5 ed e8 ff 20 e2 20 ef e8 ea f1 e5 eb e0 f5 08 00 00 80 0f 00 00 80 08 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 01 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 0d 4d 53 20 53 61 6e 73 20 53 65 72 69 66

Name=txtMsg
ProgID=VTCONTROLS.VTStaticText.1
Rect=10, 238, 291, 255
Style=50000000h
ID=0
Data=354 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 0d 4d 53 20 53 61 6e 73 20 53 65 72 69 66 0b 00 00 00 ff 00 00 00 0f 00 00 80 0f 00 00 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 1f 54 68 69 73 20 63 6c 61 73 73 69 66 69 65 72 20 61 6c 72 65 61 64 79 20 65 78 69 73 74 73 21 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 11 00 ff ff ff ff ff ff ff ff 42 4d 36 00 00 00 00 00 00 00 36 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 10 00 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 42 4d 3e 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 01 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff 00 00 00 00 00 01 00 00 00 01 00 00 00 0f 00 00 80 01 00 00 00 01 00 00 00 00 00 00 00


[Script]
On Error Resume Next

fUnitCoeff = Array( 39.37,1000000,1000,100,1)
Data.Setvalue "\UnitList\C1R0", fUnitCoeff(0)
Dim iCountUnit, iCurrentUnit, rec, PrevUnit, ImageExist
Dim MeasReasult, Coeff, Unit,UnitCoeff, Current, Row, XYcoeff, FirstCall, MakeNew
Dim CalibrName ()
Dim CalibrGUID ()
Dim CalibrCoeff ()
Dim CalibrCount
Dim sSection 
Dim UnitCount, iEditRow
sSection = "NewCalibr"
Dim CalibrObj , sAreYouSure, sDelCalibr, sDelUnit, sExternal, szUnit, sPixel
Dim CurrentImageGUID, CurrentImageCoeff,ExternalCalibr

Sub UnitListIndex
	For i=0 To 1
		For j=0 To UnitList.GetRowCount-1
			UnitList.SetKeyValue i,j,"\UnitList\"+"C"+CStr(i)+"R"+CStr(j)
		Next
	Next
End Sub

'***************************************************************
'Form event handlers.
'***************************************************************
Sub Form_OnInitialize()
'	Form.ShowButtons 9
	iEditRow = -1
	If Data.Getvalue ("\"+sSection+"\Active\") = "" Then
		Data.Setvalue "\NewCalibr\Active" , "{55D2F44D-1C07-4F7F-A54E-7426272A247C}"
	End If
	Data.Setvalue "\NewCalibr\{55D2F44D-1C07-4F7F-A54E-7426272A247C}\MeterPerPixel" , 1
	Data.Setvalue "\NewCalibr\{55D2F44D-1C07-4F7F-A54E-7426272A247C}\Name" , "Default Calibration"
	Data.Setvalue "\NewCalibr\{55D2F44D-1C07-4F7F-A54E-7426272A247C}\Active" , 0
	If Data.GetDefValue ("\Calibration\UsePix",1) Then
		chkPix.Checked = Data.Getvalue ("\Calibration\MeasPix")
	Else
		chkPix.Checked = 0
		chkPix.Visible = 0
	End If

	CalibrList.SetColumnCaption 0, Docs.LoadString ("Calibration name")
	CalibrList.SetColumnCaption 1, Docs.LoadString ("Coefficient")
	CalibrList.SetColumnCaption 2, Docs.LoadString ("Unit")
	UnitList.SetColumnCaption 0, Docs.LoadString ("Unit")
	UnitList.SetColumnCaption 1, Docs.LoadString ("Coeff.")
	btnDelete.ButtonText = Docs.LoadString ("Delete Calibration")
	AddUnit.ButtonText = Docs.LoadString ("New Unit")
	DelUnit.ButtonText = Docs.LoadString ("Delete")
	txtCoeffTitle.Text = Docs.LoadString ("Coefficient:")
	Form.Title = Docs.LoadString ("Calibration")
	sAreYouSure = Docs.LoadString ("Are you sure?")
	sDelCalibr = Docs.LoadString ("Delete Calibration!")
	sDelUnit = Docs.LoadString ("Delete Unit!")
	sExternal = Docs.LoadString ("External")
	szUnit = Split(Docs.LoadString ("inch,micron,mm,cm,m"), ",")
	sPixel = Docs.LoadString ("pixel")

	Set img = Objects.ActiveImage

	If docs.IsPointerNull(img) Then  
		ImageExist = 0
	Else
		img.GetCalibration CurrentImageCoeff,CurrentImageGUID
		ImageExist = 1
	End If
	
	FirstCall = 1
	iCountUnit = Data.Getvalue ("\UnitList\CountUnit")
	iCurrentUnit = Data.Getvalue ("\UnitList\CurrentUnit")
	For i=0 To iCountUnit-1 
		UnitList.AddRow(0) 
	Next
	UnitListIndex
	UnitList.RestoreFromData
	UnitList.SetCurentRow iCurrentUnit
	UnitCount = Ubound(szUnit) + 1
	If iCountUnit < UnitCount Then 
		While UnitList.GetRowCount>0
			UnitList.DeleteRow(0)
		Wend
		If UnitList.GetRowCount < UnitCount-1 Then
			For i=0 To UnitCount-1
				UnitList.AddRow(-1)
				UnitList.SetCellValue 0,i,szUnit(i)
				UnitList.SetCellValue 1,i,fUnitCoeff(i)
			Next		
		End If
	End If
	UnitList_CurentRowChange(UnitList.GetCurentRow)
	CalibrCount = 0
	LoadCalibr()
	rec = 0
	FirstCall = 0
	CalibrList_CurentRowChange(Current )
	If chkPix.Checked  Then chkPix_OnCheck 1
	txtMsg.Text = ""	
	If Not (MethodMan.IsRecording() or MethodMan.IsRunning())  Then  Form.EnableButtons 26
End Sub

Sub Form_OnOK()
	UnitListIndex
	UnitList.StoreToData
	
	Current = CalibrList.GetCurentRow
	CurrentExternal = 0
'	If CalibrList.GetRowCount = Current+1 And ExternalCalibr Then 
'		CurrentExternal = 1
'		CalibrGUID(Current)	= CurrentImageGUID
'		CalibrCoeff(i) = CurrentImageCoeff
'	End If
	
	If Current >= 0 Then
	Data.Setvalue "\"+sSection+"\"+"Active", CalibrGUID(Current)
	Data.Setvalue "\UnitList\CountUnit", CInt(UnitList.GetRowCount)
	Data.Setvalue "\UnitList\CurrentUnit", CInt(UnitList.GetCurentRow)
	Data.Setvalue "\Calibration\MeasPix", chkPix.Checked
	End If

	If chkPix.Checked = 1 or Current = -1 Then
		Data.Setvalue "\NewCalibr\Active" , "{55D2F44D-1C07-4F7F-A54E-7426272A247C}"
	else
		Data.Setvalue "\"+sSection+"\"+"Active", CalibrGUID(Current)
	End If
	Data.Setvalue "\Units\Linear\Name", Unit
	Data.Setvalue "\Units\Linear\CoeffToUnit", UnitCoeff
	
	Data.Setvalue "\Units\Velocity\Name", Unit + Docs.LoadString ("/s")
	Data.Setvalue "\Units\Velocity\CoeffToUnit", UnitCoeff
	If CalibrList.GetRowCount = Current+1 And ExternalCalibr Then
'		Exit Sub
	End If
	For i=0 To CalibrCount-1
		Data.Setvalue "\"+sSection+"\"+CalibrGUID(i)+"\"+"Name", CalibrList.GetCellAsString(0,i)
		Data.Setvalue "\"+sSection+"\"+CalibrGUID(i)+"\"+"MeterPerPixel", CalibrCoeff(i)
		Data.Setvalue "\"+sSection+"\"+CalibrGUID(i)+"\"+"Active", 1
	Next
	If ImageExist Then ReCalcOnChangeCalibr
	MainWnd.UpdateSystemSettings
	MainWnd.UpdateSystemSettings
	CalcMeasResult
End Sub

Sub Form_OnDestroy()
	ActionState.TerminateCurrentAction
End Sub
'***************************************************************
'CalibrList event handlers.
'***************************************************************
Sub CalibrList_DataChange(nColumn, nRow)
	If rec Then Exit Sub
	iEditRow = nRow
	CheckName()
	Coeff = CalibrCoeff(CalibrList.GetCurentRow)
	For i=0 To CalibrCount-1
		CalibrName(i) = CalibrList.GetCellAsString(0,i)
	Next
	MainWnd.UpdateSystemSettings	
	txtCoeff.Text = FormatNumber(Coeff*UnitCoeff,12)+" "+Unit+"/"+sPixel
End Sub

Sub CalibrList_CurentRowChange(nRow)
	If rec or FirstCall Then Exit Sub
	CheckName()
	Current = CalibrList.GetCurentRow
	If Current = -1 Then 
		btnDelete.Disabled = 1
		chkPix.Checked 1
		chkPix.Disabled = 1
		Exit Sub
	End If
	If ExternalCalibr and Current = CalibrCount or CalibrCount = 0 Then 	'or Current = CalibrCount 
		btnDelete.Disabled = 1
	Else
		btnDelete.Disabled = 0
		chkPix.Disabled = 0
	End If
	
	Unit = UnitList.GetCellAsString(0,UnitList.GetCurentRow)
	UnitCoeff = CDbl(UnitList.GetCellAsValue(1,UnitList.GetCurentRow))

	Coeff = CalibrCoeff(Current)
	txtCoeff.Text = FormatNumber(Coeff*UnitCoeff,12)+" "+Unit+"/"+sPixel

End Sub

Sub LoadCalibr()
	CurrentGUID = Data.Getvalue ("\"+sSection+"\Active\")
	Data.SetSection +"\"+sSection
	a = Data.GetEntriesCount 
	If a>0 Then
		ReDim  CalibrName (a+1)
		ReDim  CalibrGUID (a+1)
		ReDim  CalibrCoeff (a+1)
		ReDim  CalibrUnit (a)
		CalibrCount = 0
		For i=0 To a-1
			sStr = Data.GetEntryName (i)
			Active = Data.GetEntryName (i)
			If Left (sStr,1) = "{" Then 
				Active = Data.Getvalue ("\"+sSection+"\"+sStr+"\"+"Active")
				If Active = 1 Then
					CalibrGUID(CalibrCount) = sStr
					CalibrCount = CalibrCount + 1
				End If 
			End If 
		Next	
		For i=0 To CalibrCount-1 
			CalibrName(i) = Data.Getvalue ("\"+sSection+"\"+CalibrGUID(i)+"\"+"Name")
			CalibrCoeff(i) = Data.Getvalue ("\"+sSection+"\"+CalibrGUID(i)+"\"+"MeterPerPixel")
		Next
		For i=0 To CalibrCount-1
			CalibrList.AddRow(-1)
			CalibrList.SetCellValue 0,i,CalibrName(i)
			CalibrList.SetCellValue 1,i,CalibrCoeff(i)	
			CalibrList.SetCellValue 2,i,CalibrUnit(i)
			If CalibrGUID(i) = CurrentGUID Then Current = i
		Next
		ExternalCalibr = 1
		If IsEmpty(CurrentImageGUID) or CurrentImageGUID = "{55D2F44D-1C07-4F7F-A54E-7426272A247C}" Then
			ExternalCalibr = 0 
		Else
			For i=0 To CalibrCount-1
				If CalibrGUID(i) = CurrentImageGUID Then 
					Current = i
					ExternalCalibr = 0 
				End If
			Next
		End If
		If 	ExternalCalibr and ImageExist Then 
			CalibrList.AddRow(-1)
			CalibrName(i) = NewExternalName()
			CalibrList.SetCellValue 0,i,CalibrName(i)
			CalibrCoeff(i) = CurrentImageCoeff
			CalibrGUID(i) = CurrentImageGUID
			CalibrList.SetCellValue 1,i,CurrentImageCoeff
			Current = i
			CalibrCount = CalibrCount+1
		End If
		CalibrList.SetCurentRow Current 
	else
		chkPix.Checked 1
		chkPix_OnCheck 1
		CalibrList.Disabled 1
	End If
End Sub


'***************************************************************
'UnitList event handlers.
'***************************************************************
Sub UnitList_CurentRowChange(nRow)
	If UnitList.GetCurentRow < UnitCount Then 
		DelUnit.Disabled = 1
	Else
		DelUnit.Disabled = 0
	End If
	If FirstCall=0 Then 
		Unit = UnitList.GetCellAsString(0,UnitList.GetCurentRow)
		UnitCoeff = CDbl(UnitList.GetCellAsValue(1,UnitList.GetCurentRow))
		If CalibrList.GetRowCount = 0 Then
			txtCoeff.Text = Unit
		else
			txtCoeff.Text = FormatNumber(Coeff*UnitCoeff,12)+" "+Unit+"/"+sPixel
		End If		
	End If
	Form.EnableButtons 27
End Sub


'***************************************************************
'btnDelete event handlers.
'***************************************************************
Sub btnDelete_Click()
	Answer = MsgBox (sAreYouSure, vbYesNo+vbDefaultButton2,sDelCalibr)
	If Answer = vbYes Then 		
		Data.RemoveValue "\"+sSection+"\"+CalibrGUID(CalibrList.GetCurentRow)
		For i=CalibrList.GetCurentRow To CalibrCount-2
			CalibrName(i) = CalibrName(i+1)
			CalibrCoeff(i) = CalibrCoeff(i+1)
			CalibrGUID(i) = CalibrGUID(i+1)
		Next
		CalibrCount = CalibrCount-1 
		'Заполнение VTList //
		rec = 1
		While CalibrList.GetRowCount>0
			CalibrList.DeleteRow(0)
		Wend
		rec = 0
		For i=0 To CalibrCount-1
			CalibrList.AddRow(-1)
			CalibrList.SetCellValue 0,i,CalibrName(i)
		Next		
		If Current = -1 Then 
			Current = 0 
			CalibrList.SetCurentRow Current 
		End If
		If CalibrList.GetRowCount = 0 Then
			chkPix_OnCheck 1
		End If
	End If
	CalibrList_CurentRowChange CalibrList.GetCurentRow
End Sub
'***************************************************************
'AddUnit event handlers.
'***************************************************************
Sub AddUnit_Click()
	If FormManager.ExecuteModal ("NewUnit") = 1 Then
	
		NewCoeff = Data.Getvalue ("\tmp\2")
		NewName = Data.Getvalue ("\tmp\1")
		If NewCoeff = 0 Then Exit Sub
		UnitList.AddRow(-1)
		UnitList.SetCellValue 0,UnitList.GetRowCount-1,NewName 
		UnitList.SetCellValue 1,UnitList.GetRowCount-1,NewCoeff 
	End If
	Form.EnableButtons 27
End Sub

'***************************************************************
'DelUnit event handlers.
'***************************************************************
Sub DelUnit_Click()
	If UnitList.GetCurentRow <UnitCount-1 Then Exit Sub  
	Answer = MsgBox (sAreYouSure, vbYesNo+vbDefaultButton2,sDelUnit)
	If Answer = vbYes Then 	UnitList.DeleteRow(UnitList.GetCurentRow)
	Form.EnableButtons 27
End Sub


'***************************************************************
'chkPix event handlers.
'***************************************************************
Sub chkPix_OnCheck(nCheck)
	If nCheck = 1 Then
		Unit = sPixel
		UnitCoeff = 1
		Coeff = 1
		txtCoeff.Text = sPixel		
		CalibrList.Disabled 1
		UnitList.Disabled 1
	else	
		If CalibrList.GetRowCount > 0 Then CalibrList.Disabled 0
		UnitList.Disabled 0
		UnitList_CurentRowChange UnitList.GetRowCount
		CalibrList_CurentRowChange CalibrList.GetRowCount
	End If
	Form.EnableButtons 27
End Sub



Sub CheckName()
	txtMsg.Text = ""	
	If rec Or FirstCall Then Exit Sub	
	rec = 1
	If NameExist(CalibrList.GetCellAsString(0,iEditRow)) And iEditRow >= 0 Then
		FormManager.EnableOk false
		txtMsg.Text Docs.LoadString ("The specified name already exists!")
		CalibrList.SetCurentRow iEditRow
		CalibrList.ForceEditCell 0,iEditRow
		Form.EnableButtons 26
	else
		Form.EnableButtons 27
	End If
	rec = 0
End Sub


Function NameExist(str)
	NameExist = false
	For i=0 To CalibrCount-1
		If CalibrName(i) = str And i <> iEditRow Then
			NameExist = True
			Exit Function
		End If 
	Next
End Function

Function NewExternalName()
	Dim i,str
	str = sExternal
	i = 0
	While NameExist(str)
		i = i + 1
		str = sExternal + CStr(i)
	Wend 
	NewExternalName = str	
End Function

