[AxForm]
Version=1
Size=139, 77
Title=%Focus%

[AXControls]
Name=txtHeader
ProgID=VTCONTROLS.VTStaticText.1
Rect=11, 1, 129, 15
Style=50000000h
ID=0
Data=340 05 00 00 00 0f 00 00 80 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 02 bc 02 dc 7c 01 00 0d 4d 53 20 53 61 6e 73 20 53 65 72 69 66 0b 00 00 00 08 00 00 80 0f 00 00 80 0f 00 00 80 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 11 d0 e0 f1 f8 e8 f0 e5 ed ed fb e9 20 f4 ee ea f3 f1 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 49 4c 01 01 00 00 02 00 04 00 01 00 01 00 ff ff ff ff 11 00 ff ff ff ff ff ff ff ff 42 4d 36 00 00 00 00 00 00 00 36 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 10 00 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 42 4d 3e 00 00 00 00 00 00 00 3e 00 00 00 28 00 00 00 04 00 00 00 01 00 00 00 01 00 01 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff 00 00 00 00 00 01 00 00 00 01 00 00 00 0f 00 00 80 01 00 00 00 00 00 00 00 00 00 00 00

Name=btnInput
ProgID=PUSHBUTTON.PushButtonCtrl.1
Rect=12, 23, 118, 67
Style=50000000h
ID=0
Data=3347 0c 01 00 01 00 00 00 00 00 1a 44 3a 5c 76 74 35 72 65 73 5c 69 63 6f 6e 73 5c 41 46 6f 6b 75 73 2e 62 6d 70 1a 44 3a 5c 76 74 35 72 65 73 5c 69 63 6f 6e 73 5c 41 46 6f 6b 75 73 2e 62 6d 70 01 00 01 00 01 00 00 00 00 05 49 6e 70 75 74 00 00 05 00 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 14 04 01 01 47 00 00 00 76 00 00 00 04 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 0d 4d 53 20 53 61 6e 73 20 53 65 72 69 66 00 00 00 00 00 00 00 00 00 ff 00 ff 00 08 00 00 80 08 00 00 80 08 00 00 80 08 00 00 80 00 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 10 49 6e 70 75 74 20 6e 65 78 74 20 69 6d 61 67 65 01 00 42 4d 36 0c 00 00 00 00 00 00 36 00 00 00 28 00 00 00 20 00 00 00 20 00 00 00 01 00 18 00 00 00 00 00 00 0c 00 00 12 0b 00 00 12 0b 00 00 00 00 00 00 00 00 00 00 ff 00 ff ff 00 ff ba c8 cb af bd c0 af bd c0 af bd c0 af bd c0 af bd c0 af bd c0 af bd c0 af bd c0 af bd c0 af bd c0 af bd c0 af bd c0 ba c8 cb ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ba c8 cb 7d 87 89 5f 66 68 5f 66 68 5f 66 68 5f 66 68 5f 66 68 5f 66 68 5f 66 68 5f 66 68 5f 66 68 5f 66 68 5f 66 68 5f 66 68 7d 87 89 ba c8 cb ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff e9 f5 fd 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff e9 f5 fd 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff d9 ee fc 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff c8 e7 fb 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff b7 e0 fa 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff a7 d9 f9 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 55 5b 5d 91 9c 9e af bd c0 af bd c0 af bd c0 af bd c0 af bd c0 af bd c0 af bd c0 ba c8 cb ce de e1 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 9a d3 f8 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 40 45 46 55 5b 5d 5f 66 68 5f 66 68 5f 66 68 5f 66 68 5f 66 68 5f 66 68 5f 66 68 7d 87 89 ba c8 cb ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 91 cf f7 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 91 cf f7 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 91 cf f7 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 ff fd fc ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 91 cf f7 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 ff fa f4 ff fc f9 ff fe fd ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 91 cf f7 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 ff f5 ec ff f8 f2 ff fb f7 ff fd fc ff ff ff ff ff ff ff ff ff ff ff ff 77 5e 52 55 5b 5d 91 9c 9e af bd c0 af bd c0 af bd c0 af bd c0 ba c8 cb ff 00 ff ff 00 ff 91 cf f7 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 ff f0 e1 ff f4 e8 ff f7 ef ff fa f4 ff fc f9 ff fe fd ff ff ff ff ff ff 77 5e 52 40 45 46 55 5b 5d 5f 66 68 5f 66 68 5f 66 68 5f 66 68 7d 87 89 ba c8 cb ff 00 ff 91 cf f7 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 ff eb d7 ff ef de ff f2 e5 ff f5 ec ff f8 f2 ff fb f7 ff fd fc ff ff ff 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 5f 66 68 af bd c0 ff 00 ff 91 cf f7 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 ff e6 cd ff ea d4 ff ed da ff f0 e1 ff f4 e8 ff f7 ef ff fa f4 ff fc f9 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 5f 66 68 af bd c0 ff 00 ff 91 cf f7 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 ff e2 c3 ff e5 c9 ff e8 d0 ff eb d7 ff ef de ff f2 e5 ff f5 ec ff f8 f2 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 5f 66 68 af bd c0 ff 00 ff 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 8e c3 e6 b3 d7 eb d5 e0 e3 f2 ea df ff de bc ff e0 c1 ff e3 c6 ff e6 cd ff ea d4 ff ed da ff f0 e1 ff f4 e8 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 91 cf f7 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff dd b9 ff df be ff e2 c3 ff e5 c9 ff e8 d0 ff eb d7 ff ef de 77 5e 52 ff dc b9 ff db b6 ff db b6 ff db b6 ff db b6 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff 00 ff ff 00 ff 91 cf f7 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff dc b8 ff de bc ff e0 c1 ff e3 c6 ff e6 cd ff ea d4 77 5e 52 ff df bf ff dd ba ff db b6 ff db b6 ff db b6 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 91 cf f7 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff dd b9 ff df be ff e2 c3 ff e5 c9 77 5e 52 ff e3 c6 ff e0 c0 ff dd bb ff db b7 ff db b6 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff 00 ff ff 00 ff 91 cf f7 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff dc b8 ff de bc ff e0 c1 77 5e 52 ff e7 ce ff e3 c7 ff e0 c1 ff de bc ff dc b7 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 91 cf f7 77 5e 52 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff db b6 ff dd b9 77 5e 52 ff eb d7 ff e8 cf ff e4 c8 ff e1 c2 ff de bc 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 91 cf f7 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 ff f0 e0 ff ec d8 ff e8 d1 ff e5 ca ff e2 c3 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 9e d5 f8 b2 dd f9 c8 e7 fb de f1 fd f2 f9 fe ff f4 e8 ff f0 e1 ff ed da ff e9 d2 ff e5 cb 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 91 cf f7 77 5e 52 ff ff ff ff ff ff ff ff ff ff ff ff ff fd fb ff fb f6 ff f8 f0 ff f5 ea ff f1 e3 ff ed db ff ea d4 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 00 00 00 ff 00 ff ff 00 ff ff 00 ff ff 00 ff 91 cf f7 77 5e 52 ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff fe fc ff fb f7 ff f8 f2 ff f5 eb ff f2 e4 ff ee dd 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 00 00 00 ff 00 ff ff 00 ff ff 00 ff ff 00 ff 91 cf f7 77 5e 52 ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff fe fd ff fc f8 ff f9 f3 ff f6 ed ff f2 e6 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff 00 ff ff 00 ff 91 cf f7 77 5e 52 ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff fe fe ff fc f9 ff fa f4 ff f7 ee 77 5e 52 5f 66 68 af bd c0 ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 00 00 00 ff 00 ff ff 00 ff ff 00 ff ff 00 ff 91 cf f7 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 77 5e 52 7d 87 89 ba c8 cb ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff ff 00 ff 00 00 00 ff 00 ff ff 00 ff ff 00 ff ff 00 ff 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 91 cf f7 9e d5 f8 b2 dd f9 c8 e7 fb de f1 fd de f1 fd ba c8 cb ff 00 ff

Name=Control152
ProgID=VTDESIGN.VTD3DBarCtrl.1
Rect=3, 15, 128, 20
Style=50000000h
ID=0
Data=72 00 00 00 00 03 00 00 00 03 00 02 00 00 00 05 00 00 80 01 00 00 00 08 00 00 80 00 64 00 00 00 00 00 01 00 01 00 00 00 00 03 52 e3 0b 91 8f ce 11 9d e3 00 aa 00 4b b8 51 01 cc 00 00 90 01 44 42 01 00 05 41 72 69 61 6c


[Script]
option explicit

Dim global, z1,z0, img, iDeleteFilterArgs, sResult,bLiveVideoSupport, res
Set global = Application.GetglobalScript("")
sResult = Docs.LoadString ("Focus Enhancement")
bLiveVideoSupport = InputDriverManager.GetValue("IsLiveVideo")
z0 = 1
z1 = 1
'***************************************************************
'Form event handlers.
'***************************************************************
Sub Form_OnInitialize()
	iDeleteFilterArgs = Data.Getvalue ("\General\DeleteFilterArgs")
	Data.Setvalue "\General\DeleteFilterArgs",0
	If Objects.GetObjectCount ("Image")>1 Then
		MakeFocus()			
	End If
	txtHeader.Text = Docs.LoadString ("Focus Enhancement")
	btnInput.ButtonText = Docs.LoadString ("Input")
	btnInput.ToolTip = Docs.LoadString ("Input Next Image")
'	res = ActionManager.InputImageInCurrentDoc (0,1,1)
	ActionManager.FitDoc2Screen
	If bLiveVideoSupport Then global.WindowSplitHor 2, "PreviewDoc.PreviewView", "ImageDoc.ImageView", 1	
	If Objects.GetObjectCount ("Image")>1 Then
		MakeFocus()			
	End If
End Sub
Sub Form_OnOK()	
	If global.ExistObjectByName(sResult) Then DelObjectsEx(sResult)
End Sub
sub Form_OnDestroy()
	Set global = Nothing
	Data.Setvalue "\General\DeleteFilterArgs",iDeleteFilterArgs
end sub

'***************************************************************
'btnInput event handlers.
'***************************************************************
sub btnInput_Click()
	ActionState.BeginGroupUndo "1"
	If global.ExistObj ("Image") Then z0 = global.GetCurrentZoom(0,0)
	If bLiveVideoSupport Then
		z1 = global.GetCurrentZoom(1,0)
		If ActionManager.InputImageInCurrentDoc (0,0,0)=1 Then
			global.SetZoom 0,0,z0
			global.SetZoom 1,0,z1
			If Objects.GetObjectCount ("Image")>1 Then
				MakeFocus()			
			End If
		End If 
	Else
		If ActionManager.InputImageInCurrentDoc (0,1,0)=1 Then
			global.SetZoom 0,0,z0
			If Objects.GetObjectCount ("Image")>1 Then
				MakeFocus()			
			End If
		End If 	
	End If
	ActionState.EndGroupUndo "1"
end sub

Sub MakeFocus()
	Dim lpos,obj
	ObjectDelete sResult
	lPos = Objects.GetFirstObjectPos("Image")
	while lPos <> 0
		Set obj = Objects.GetObject("Image", lPos)
		lPos = Objects.GetNextObjectPos("Image",lPos)
		Objects.SelectObject obj, 1
		Set obj = Nothing
	wend
	CollectByMasks sResult
End Sub

Sub DelObjectsEx(sName)
	Dim sType,lPos,obj
	sType = "Image"
	lPos = Objects.GetFirstObjectPos(sType)
	while lPos <> 0
		Set obj = Objects.GetObject(sType, lPos)
		lPos = Objects.GetNextObjectPos(sType,lPos)
		If obj.Name <> sName Then 
			Objects.RemoveObject obj
		End If
		Set obj = Nothing
	wend
End Sub